<?xml version="1.0" encoding="ISO-8859-1"?>
<!--
For online publishing use:
<?xml-stylesheet type="text/xsl"
href="http://docs.oasis-open.org/templates/DocBook/spec-0.5/stylesheets/oasis-specification-html.xsl"?>
<!DOCTYPE article
  PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
"http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd"
-->
<?xml-stylesheet type="text/xsl"
href="spec-0.5/stylesheets/oasis-specification-html-offline.xsl"?>
<!DOCTYPE article
  PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN"
"spec-0.5/docbook/docbookx.dtd" 
[
<!--the document properties-->
<!ENTITY name "csig-dss-extension">
<!ENTITY pversion "1.0">
<!ENTITY version "1.1">
<!ENTITY stage "draft">
<!ENTITY standard "Swedish eID Framework Specification">
<!ENTITY this-loc   "http://aaa-sec.com/csig/specification">
<!ENTITY previous-loc "http://aaa-sec.com/eid2/specification/eid2dssext-&pversion;">
<!ENTITY latest-loc   "http://aaa-sec.com/eid2/specification">
<!ENTITY pubdate "14 August 2015">
]>
<article status="&standard;">
    <articleinfo>
        <title>DSS Extension for Federated Central Signing Services - Version &version;</title>
        <releaseinfo role="cvs">
            <?nospell-start?>$Id: spectools-docbook-template-wd03.xml,v 1.4 2010/07/08 12:28:15
            admin Exp $<?nospell-end?>
        </releaseinfo>
        <productname>&name;</productname>
        <productnumber>&stage;</productnumber>

        <releaseinfo role="OASIS-specification-this-authoritative">&this-loc;/&name;-&version;.html</releaseinfo>
        <releaseinfo role="OASIS-specification-this">&this-loc;/&name;-&version;.pdf</releaseinfo>
        <releaseinfo role="OASIS-specification-this">&this-loc;/&name;-&version;.docx</releaseinfo>

        <releaseinfo role="OASIS-specification-previous">&previous-loc;.html</releaseinfo>
        <releaseinfo role="OASIS-specification-previous">&previous-loc;.pdf</releaseinfo>
        <releaseinfo role="OASIS-specification-previous">&previous-loc;.xml</releaseinfo>

        <releaseinfo role="OASIS-specification-latest-authoritative">&latest-loc;/&name;-&version;.html</releaseinfo>

<!--
        <releaseinfo role="OASIS-specification-latest">&latest-loc;/&name;.pdf</releaseinfo>
        <releaseinfo role="OASIS-specification-latest">&latest-loc;/&name;.xml</releaseinfo>
-->
        <?nospell-end?>
        <releaseinfo role="committee"><ulink url="http://www.elegnamnden.se">The Swedish
                E-identification Board</ulink></releaseinfo>
        <authorgroup>
            <editor>
                <firstname>Stefan</firstname>
                <surname>Santesson</surname>
                <affiliation>
                    <orgname>E-legitimationsnï¿½mnden</orgname>
                    <address><email>stefan@aaa-sec.com</email></address>
                </affiliation>
            </editor>
        </authorgroup>
        <pubdate>&pubdate;</pubdate>
        <copyright>
            <year>2015</year>
            <holder>Swedish e-identification board. All Rights Reserved.</holder>
        </copyright>
        <legalnotice role="related">
            <title>Related Work</title>
            <para>This specification is related to:</para>
            <itemizedlist spacing="compact">
                <listitem>
                    <para>
                        <ulink
                            url="http://docs.oasis-open.org/dss/v1.0/oasis-dss-core-spec-v1.0-os.html"
                            >Digital Signature Service Core Protocols, Elements, and Bindings
                            Version 1.0</ulink></para>
                </listitem>
            </itemizedlist>
        </legalnotice>
        <legalnotice role="namespaces">
            <title>Declared XML Namespaces</title>
            <para><ulink url="http://docs.oasis-open.org/"
                >http://docs.oasis-open.org/</ulink></para>
        </legalnotice>
        <abstract>
            <para>This specification defines an esxtension to the OASIS DSS protocol for providing
                centralized signing services for E-government services within the identity
                federation for public agencies operated by the Swedish E-identification
                board.</para>
        </abstract>
        <legalnotice role="status">
            <title>Status</title>
            <para>This specification is published by the Swedish E-identifiaction Board. </para>
        </legalnotice>
        <legalnotice role="notices">
            <title>Notices</title>
            <para>Copyright &#169; Swedish E-identification Board 2015. All Rights Reserved.</para>
            <para>This specification is defines an extension to the OASIS DSS protocol. It is
                provided in OASIS document format in order to allow it to be submitted to OASIS for
                adoption at a later stage. In it's current version, this specification is developed
                outside of OASIS technical committees.</para>
        </legalnotice>
    </articleinfo>
    <section>
        <title>Introduction</title>
        <para>This specifications defines elements that extends the
                <literal>&lt;dss:SignRequest></literal> and <literal>&lt;dss:SignResponse></literal>
            elements of <xref linkend="dss"/>.</para>
        <para>One element <literal>&lt;SignRequestExtension></literal> is defined for extending sign
            requests and one element <literal>&lt;SignResponseExtension></literal> is defined for
            extending sign responses. The <literal>&lt;SignTasks></literal> element extends the
            extends <literal>&lt;dss:InputDocuments></literal> of sign requests and
                <literal>&lt;dss:SignatureObject></literal> of sign responses.</para>
        <para>These extensions to the DSS protocols provide essential protocol elements in a
            scenario where:</para>
        <itemizedlist>
            <listitem>
                <para>The user's signature is requested by a service with which the user has an
                    active session and where this service has authenticated the user using a SAML
                    assertion</para>
            </listitem>
            <listitem>
                <para>The service provider holds the data to be signed</para>
            </listitem>
            <listitem>
                <para>The central signing service is requested to authenticate the user with the
                    same <glossterm>Identity Provider</glossterm> that was used to authenticate the
                    user to the Service provider.</para>
            </listitem>
        </itemizedlist>
        <para>This particular use case is relevant when a user logs in to a service using federated
            identity, where the user at some point is required to sign some data such as a tax
            declaration or payment transaction. The user is forwarded to the signing service
            together with a sign request from the service provider, specifying the information to be
            signed together with the conditions for signing. After completed signing, the user is
            returned to the service provider together with a sign response from which the service
            provider can assemble a complete signed document, signed by the user.</para>
        <para>This scenario requires more information in both sign request and sign response than
            the original DSS core standard provides and it also requires the capability to let the
            service provider sign the sign request.</para>
        <section>
            <title>Terminology</title>
            <section>
                <title> Key words</title>
                <para>The key words <glossterm>MUST</glossterm>, <glossterm>MUST NOT</glossterm>,
                        <glossterm>REQUIRED</glossterm>, <glossterm>SHALL</glossterm>,
                        <glossterm>SHALL NOT</glossterm>, <glossterm>SHOULD</glossterm>,
                        <glossterm>SHOULD NOT</glossterm>, <glossterm>RECOMMENDED</glossterm>,
                        <glossterm>MAY</glossterm>, and <glossterm>OPTIONAL</glossterm> are to be
                    interpreted as described in <xref linkend="rfc2119"/>.</para>
                <para>These keywords are capitalized when used to unambiguously specify requirements
                    over protocol features and behavior that affect the interoperability and
                    security of implementations.</para>
                <para>When these words are not capitalized, they are meant in their natural-language
                    sense.</para>
            </section>
            <section>
                <title>Structure</title>
                <para>This specification uses the following typographical conventions in text:
                        <literal>&lt;ThisSpecifictionElements></literal>,
                        <literal>&lt;ns:ForeignElement></literal>, <literal>Attribute</literal>,
                        <emphasis role="bold">Datatype</emphasis>,
                    <literal>OtherCode</literal>.</para>
                <para>
                    <programlisting><![CDATA[
Listings of DSS schemas appear like this.
]]></programlisting>
                </para>
            </section>
            <section>
                <title> Definitions</title>
                <variablelist>
                    <varlistentry>
                        <term>Identity Provider</term>
                        <listitem>
                            <para> An Identity Provider that is assigned to authenticate the
                                signer</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Signing Service</term>
                        <listitem>
                            <para> A Signing Service that receives sign requests and responds with
                                sign responses according to this specification.</para>
                        </listitem>
                    </varlistentry>
                    <varlistentry>
                        <term>Service Provider</term>
                        <listitem>
                            <para> A service that has identified the signer through the user's
                                Identity Provider and requests that the signer signs some data using
                                the Central Signing Service.</para>
                        </listitem>
                    </varlistentry>
                </variablelist>
            </section>
        </section>
        <section>
            <title>Normative References</title>
            <!--note that at least one paragraph (and it can be empty) is needed to satisfy the DocBook document model-->
            <para/>
            <bibliography>
                <title/>
                <bibliomixed id="csig-xsd"><abbrev>Csig-XSD</abbrev>
                    <title>This specification's DSS Extensions schema</title> (Provided in this
                    document), August 2015.</bibliomixed>
                <bibliomixed id="dss"><abbrev>OASIS-DSS</abbrev>
                    <title>Digital Signature Service Core Protocols, Elements, and Bindings Version
                        1.0</title>, <citetitle><ulink
                            url="http://docs.oasis-open.org/dss/v1.0/oasis-dss-core-spec-v1.0-os.html"
                            >http://docs.oasis-open.org/dss/v1.0/oasis-dss-core-spec-v1.0-os.html</ulink></citetitle>,
                    OASIS, 11 April 2007.</bibliomixed>
                <bibliomixed id="rfc2119"><abbrev>RFC 2119</abbrev>S. Bradner, <title>Key words for
                        use in RFCs to Indicate Requirement Levels</title>, <citetitle><ulink
                            url="http://www.ietf.org/rfc/rfc2119.txt"
                            >http://www.ietf.org/rfc/rfc2119.txt</ulink></citetitle>, IETF (Internet
                    Engineering Task Force) RFC 2119, March 1997.</bibliomixed>
                <bibliomixed id="rfc3986"><abbrev>RFC 3986</abbrev>T. Berners-Lee, R. Fielding, L.
                    Masinter <title>Uniform Resource Identifier (URI): Generic Syntax</title>,
                            <citetitle><ulink url="http://www.ietf.org/rfc/rfc3986.txt"
                            >http://www.ietf.org/rfc/rfc3986.txt</ulink></citetitle>, IETF (Internet
                    Engineering Task Force) RFC 3986, January 2005.</bibliomixed>
                <bibliomixed id="rfc5652"><abbrev>RFC 5652</abbrev>R. Housley <title>Cryptographic
                        Message Syntax (CMS)</title>, <citetitle><ulink
                            url="http://www.ietf.org/rfc/rfc5652.txt"
                            >http://www.ietf.org/rfc/rfc5652.txt</ulink></citetitle>, IETF (Internet
                    Engineering Task Force) RFC 5652, September 2009.</bibliomixed>
                <bibliomixed id="rfc5280"><abbrev>RFC 5280</abbrev>Cooper, D., Santesson, S.,
                    Farrell, S., Boeyen, S., Housley, R., and W. Polk. <title>Internet X.509 Public
                        Key Infrastructure Certificate and Certificate Revocation List (CRL)
                        Profile</title>, <citetitle><ulink url="http://www.ietf.org/rfc/rfc5280.txt"
                            >http://www.ietf.org/rfc/rfc5280.txt</ulink></citetitle>, IETF (Internet
                    Engineering Task Force) RFC 5280, May 2008.</bibliomixed>
                <bibliomixed id="saml"><abbrev>SAML2.0</abbrev>Scott Cantor, John Kemp, Rob
                    Philpott, Eve Maler <title>Assertions and Protocols for the OASIS Security
                        Assertion Markup Language (SAML) V2.0</title>, <citetitle><ulink
                            url="http://docs.oasis-open.org/security/saml/v2.0/"
                            >http://docs.oasis-open.org/security/saml/v2.0/</ulink></citetitle>,
                    OASIS Standard, 15 March 2005.</bibliomixed>
                <bibliomixed id="schema1"><abbrev>Schema1</abbrev>H. S. Thompson et al. <title>XML
                        Schema Part 1: Structures</title>, <citetitle><ulink
                            url="http://www.w3.org/TR/xmlschema-1/"
                            >http://www.w3.org/TR/xmlschema-1/</ulink></citetitle>, W3C
                    Recommendation, May 2001.</bibliomixed>
                <bibliomixed id="schema2"><abbrev>Schema2</abbrev>P. V. Biron et al. <title>XML
                        Schema Part 2: Datatypes. </title>
                    <citetitle><ulink url="http://www.w3.org/TR/xmlschema-2/"
                            >http://www.w3.org/TR/xmlschema-2/</ulink>
                    </citetitle>, W3C Recommendation, May 2001.</bibliomixed>
                <bibliomixed id="xades"><abbrev>XAdES</abbrev>
                    <title>XML Advanced Electronic Signatures</title>, <citetitle><ulink
                            url="http://www.etsi.org/deliver/etsi_ts/101900_101999/101903/01.04.02_60/ts_101903v010402p.pdf"
                            >http://www.etsi.org/deliver/etsi_ts/101900_101999/101903/01.04.02_60/ts_101903v010402p.pdf</ulink></citetitle>,
                    ETSI, December 2010.</bibliomixed>
                <bibliomixed id="xml"><abbrev>XML</abbrev>
                    <title>Extensible Markup Language (XML) 1.0 (Fifth Edition)</title>,
                            <citetitle><ulink
                            url=" http://www.w3.org/TR/REC-xml/#sec-element-content">
                            http://www.w3.org/TR/REC-xml/#sec-element-content</ulink></citetitle>,
                    W3C Recommendation 26 November 2008.</bibliomixed>
                <bibliomixed id="xml-ns"><abbrev>XML-ns</abbrev>T. Bray, D. Hollander, A. Layman.
                        <title>Namespaces in XML</title>, <citetitle><ulink
                            url="http://www.w3.org/TR/1999/REC-xml-names-19990114"
                            >http://www.w3.org/TR/1999/REC-xml-names-19990114</ulink></citetitle>,
                    W3C Recommendation, January 1999.</bibliomixed>
                <bibliomixed id="xmldsig"><abbrev>XMLDSIG</abbrev>D. Eastlake et al,
                        <title>XML-Signature Syntax and Processing</title>, <citetitle><ulink
                            url="http://www.w3.org/TR/2002/REC-xmldsig-core-20020212/"
                            >http://www.w3.org/TR/2002/REC-xmldsig-core-20020212/</ulink></citetitle>,
                    W3C Recommendation, February 2002.</bibliomixed>
            </bibliography>
        </section>
        <section>
            <title>Non-Normative References</title>
            <para/>
            <bibliography>
                <title/>
                <bibliomixed id="w3cchar"><abbrev>W3C-CHAR</abbrev>M. J. Dï¿½rst. <title>Requirements
                        for String Identity Matching and String Indexing. </title>
                    <citetitle><ulink url="http://www.w3.org/TR/WD-charreq"
                            >http://www.w3.org/TR/WD-charreq/</ulink>
                    </citetitle>, World Wide Web Consortium, July 1998.</bibliomixed>
            </bibliography>
        </section>
        <section>
            <title>Schema Organization and Namespaces</title>
            <para>The structures described in this specification are contained in the XML schema for
                this protocol <xref linkend="csig-xsd"/>. All schema listings in the current
                document are excerpts from the complete XML schema. In the case of a disagreement
                between the schema file and this document, the complete schema provided in the end
                of this document takes precedence.</para>
            <para>This schema is associated with the following XML namespace:</para>
            <para>
                <programlisting><![CDATA[
http://id.elegnamnden.se/csig/1.1/dss-ext/ns
]]></programlisting>
            </para>
            <para>If a future version of this specification is needed, it will use a different
                namespace.</para>
            <para>Conventional XML namespace prefixes are used in the schema:</para>
            <itemizedlist>
                <listitem>
                    <para>The prefix <literal>csig:</literal> stands for the this specification's
                        XML schema namespace <xref linkend="csig-xsd"/>.</para>
                </listitem>
                <listitem>
                    <para>The prefix <literal>dss:</literal> stands for the DSS core namespace <xref
                            linkend="dss"/>.</para>
                </listitem>
                <listitem>
                    <para>The prefix <literal>ds:</literal> stands for the W3C XML Signature
                        namespace <xref linkend="xmldsig"/>.</para>
                </listitem>
                <listitem>
                    <para>The prefix <literal>xs:</literal> stands for the W3C XML Schema namespace
                            <xref linkend="schema1"/>.</para>
                </listitem>
                <listitem>
                    <para>The prefix <literal>saml:</literal> stands for the OASIS SAML Schema
                        namespace <xref linkend="saml"/>.</para>
                </listitem>
                <listitem>
                    <para>The prefix <literal>saml:</literal> stands for the ETSI XAdES Schema
                        namespace <xref linkend="xades"/>.</para>
                </listitem>
            </itemizedlist>
            <para>Applications MAY use different namespace prefixes, and MAY use whatever namespace
                defaulting/scoping conventions they desire, as long as they are compliant with the
                Namespaces in XML specification <xref linkend="xml-ns"/>.</para>
            <para>The following schema fragment defines the XML namespaces and other header
                information for this specification's core XML schema:</para>
            <para>
                <programlisting><![CDATA[
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified"
    xmlns:ds="http://www.w3.org/2000/09/xmldsig#"
    targetNamespace="http://id.elegnamnden.se/csig/1.1/dss-ext/ns"
    xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:dss="urn:oasis:names:tc:dss:1.0:core:schema"
    xmlns:csig="http://id.elegnamnden.se/csig/1.1/dss-ext/ns">
    <xs:import namespace="urn:oasis:names:tc:SAML:2.0:assertion"
        schemaLocation="saml-schema-assertion-2.0.xsd"/>
]]></programlisting>
            </para>
        </section>
        <section>
            <title>Common Data Types</title>
            <para>The following sections define how to use and interpret common data types that
                appear throughout the specification.</para>
            <section>
                <title>String values</title>
                <para>All string values have the type <emphasis role="bold">xs:string</emphasis>, which is built
                    in to the W3C XML Schema Datatypes specification <xref linkend="schema2"/>.
                    Unless otherwise noted in this specification or particular profiles, all strings
                    in this specification MUST consist of at least one non-whitespace character
                    (whitespace is defined in the XML Recommendation <xref linkend="xml"/> Section
                    2.3).</para>
                <para>Unless otherwise noted in this specification, all elements that have the XML
                    Schema <emphasis role="bold">xs:string</emphasis> type, or a type derived from
                    that, MUST be compared using an exact binary comparison. In particular,
                    implementations MUST NOT depend on caseinsensitive string comparisons,
                    normalization or trimming of whitespace, or conversion of locale-specific
                    formats such as numbers or currency. This requirement is intended to conform to
                    the W3C working-draft Requirements for String Identity, Matching, and String
                    Indexing <xref linkend="w3cchar"/>.</para>
            </section>
            <section>
                <title>URI Values</title>
                <para>All SAML URI reference values have the type <emphasis role="bold"
                        >xs:anyURI</emphasis>, which is built in to the W3C XML Schema Datatypes
                    specification <xref linkend="schema2"/>.</para>
                <para>Unless otherwise indicated in this specification, all URI reference values
                    used within defined elements or attributes MUST consist of at least one
                    non-whitespace character, and are REQUIRED to be absolute <xref
                        linkend="rfc3986"/>.</para>
                <para>Note that this specification makes use of URI references as identifiers, such
                    as status codes, format types, attribute and system entity names, etc. In such
                    cases, it is essential that the values be both unique and consistent, such that
                    the same URI is never used at different times to represent different underlying
                    information.</para>
            </section>
            <section>
                <title>Time Values</title>
                <para>All time values have the type <emphasis role="bold">xs:dateTime</emphasis>,
                    which is built in to the W3C XML Schema Datatypes specification <xref
                        linkend="schema2"/>, and MUST be expressed in UTC form, with no time zone
                    component.</para>
                <para>Implementations SHOULD NOT rely on time resolution finer than milliseconds.
                    Implementations MUST NOT generate time instants that specify leap
                    seconds.</para>
            </section>
            <section>
                <title>MIME Types for <literal>&lt;dss:TransformedData></literal></title>
                <para>The following MIME type is defined for transformed data included in a
                        <literal>&lt;dss:Base64Data></literal> element within a
                        <literal>&lt;dss:TransformedData></literal> element in a
                        <literal>&lt;dss:SignRequest></literal>.<glosslist>
                        <glossentry>
                            <glossterm><emphasis role="bold"
                                    >application/cms-signed-attributes</emphasis></glossterm>
                            <glossdef>
                                <para>This MIME type identifies that the data contained in the
                                        <literal>&lt;dss:Base64Data></literal> element, is a DER
                                    encoded CMS signed attributes structure <xref linkend="rfc5652"
                                    />. This data is useful when signing a PDF document in cases
                                    where the whole PDF document is not included in the request. The
                                    signature on a PDF document is generated by signing the hash of
                                    a CMS signed attributes structure representing the PDF document
                                    to be signed. These signed attributes includes data that a
                                    Signing Service may want to check before signing, such as the
                                    claimed signing time.</para>
                            </glossdef>
                        </glossentry>
                    </glosslist></para>
            </section>
        </section>
    </section>
    <section>
        <title>Common Protocol Structures</title>
        <para>The following sections describe XML structures and types that are used in multiple
            places.</para>
        <section>
            <title>Type AnyType</title>
            <para>The <emphasis role="bold">AnyType</emphasis> complex type allows arbitrary XML
                element content within an element of this type (see section 3.2.1 Element Content
                    <xref linkend="xml"/>).</para>
            <para>
                <programlisting><![CDATA[
    <xs:complexType name="AnyType">
        <xs:sequence>
            <xs:any processContents="lax" minOccurs="0" maxOccurs="unbounded"/>
        </xs:sequence>
    </xs:complexType>
]]></programlisting>
            </para>
        </section>
    </section>
    <section>
        <title>Federated signing DSS Extensions</title>
        <para>This section defines elements that extends the <literal>&lt;dss:SignRequest></literal>
            and <literal>&lt;dss:SignResponse></literal> elements of the DSS Signing
            Protocol.</para>
        <section>
            <title>Element &lt;SignRequestExtension></title>
            <para>The <literal>&lt;SignRequestExtension></literal> element allows a requesting
                service to add essential sign request information to a DSS Sign request. When
                present, this element MUST be included in the
                    <literal>&lt;dss:OptionalInputs></literal> element in a DSS Sign Request. This
                element's <emphasis role="bold">SignRequestExtensionType</emphasis> complex type
                includes the following attributes and elements:</para>
            <glosslist>
                <glossentry>
                    <glossterm><literal>Version</literal> [Optional] (Default
                            "<literal>1.1</literal>")</glossterm>
                    <glossdef>
                        <para>The version of this specification. If absent, the version value
                            defaults to "1.1". This attribute provides means for the receiving
                            service to determine the expected syntax of the request based on the
                            protocol version.</para>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm><literal>&lt;RequestTime></literal> [Required]</glossterm>
                    <glossdef>
                        <para>The time when this request was created. </para>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm><literal>&lt;saml:Conditions></literal> [Required]</glossterm>
                    <glossdef>
                        <para>Conditions that MUST be evaluated when assessing the validity of
                            and/or when using the Sign Request. See Section 2.5 of <xref
                                linkend="saml"/>for additional information on how to evaluate
                            conditions.</para>
                        <para>This element MUST include the attributes NotBefore and NotOnOrAfter
                            and MUST include the element
                                <literal>&lt;saml:AudienceRestriction></literal> which in turn MUST
                            contain one <literal>&lt;saml:Audience></literal> element, specifying
                            the return URL for any resulting Sign Response message.</para>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm><literal>&lt;Signer></literal> [Optional]</glossterm>
                    <glossdef>
                        <para>The identity of the signer expressed as a sequence of SAML attributes
                            using the <emphasis role="bold">saml:AttributeStatementType</emphasis>
                            complex type. If this element is present, then the Signing Service MUST
                            verify that the authenticated identity of the signer is consistent with
                            the attributes in this element.</para>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm><literal>&lt;IdentityProvider></literal> [Required]</glossterm>
                    <glossdef>
                        <para>The SAML EntityID of the Identity Provider that MUST be used to
                            authenticate the signer before signing. The EntitID value is specified
                            using the <emphasis role="bold">saml:NameIDType</emphasis> complex type
                            and MUST include a <literal>Format</literal> attribute with the value
                                <literal>urn:oasis:names:tc:SAML:2.0:nameid-format:entity</literal>.</para>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm><literal>&lt;SignRequester></literal> [Required]</glossterm>
                    <glossdef>
                        <para>The SAML EntityID of the service that sends this request to the
                            Signing Service. The EntityID value is specified using the <emphasis
                                role="bold">saml:NameIDType</emphasis> complex type and MUST include
                            a <literal>Format</literal> attribute with the value
                                <literal>urn:oasis:names:tc:SAML:2.0:nameid-format:entity</literal>.</para>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm><literal>&lt;SignService></literal> [Required]</glossterm>
                    <glossdef>
                        <para>The SAML EntityID of the service to which this Sign Request is sent.
                            The EntityID value is specified using the <emphasis role="bold"
                                >saml:NameIDType</emphasis> complex type and MUST include a
                                <literal>Format</literal> attribute with the value
                                <literal>urn:oasis:names:tc:SAML:2.0:nameid-format:entity</literal>.</para>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm><literal>&lt;RequestedSignatureAlgorithm></literal>
                        [Optional]</glossterm>
                    <glossdef>
                        <para>An identifier of the signature algorithm the requesting service
                            prefers when generating the requested signature.</para>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm><literal>&lt;SignMessage></literal> [Optional]</glossterm>
                    <glossdef>
                        <para>Optional sign message with information to the signer about the
                            reguested signature.</para>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm><literal>&lt;CertRequestProperties></literal> [Optional]</glossterm>
                    <glossdef>
                        <para>An optional set of requested properties of the signature certificate
                            that is generated as part of the signature process.</para>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm><literal>&lt;OtherRequestInfo></literal> [Optional]</glossterm>
                    <glossdef>
                        <para>Any additional inputs to the request extension. </para>
                    </glossdef>
                </glossentry>
            </glosslist>
            <para>The following schema fragment defines the
                    <literal>&lt;SignRequestExtension></literal> element and its <emphasis
                    role="bold">SignRequestExtensionType</emphasis> complex type:</para>
            <para>
                <programlisting><![CDATA[
    <xs:element name="SignRequestExtension" type="csig:SignRequestExtensionType"/>
    <xs:complexType name="SignRequestExtensionType">
        <xs:sequence>
            <xs:element ref="csig:RequestTime"/>
            <xs:element ref="saml:Conditions"/>
            <xs:element ref="csig:Signer" minOccurs="0"/>
            <xs:element ref="csig:IdentityProvider"/>
            <xs:element ref="csig:SignRequester"/>
            <xs:element ref="csig:SignService"/>
            <xs:element minOccurs="0" ref="csig:RequestedSignatureAlgorithm"/>
            <xs:element minOccurs="0" ref="csig:CertRequestProperties"/>
            <xs:element minOccurs="0" ref="csig:SignMessage" maxOccurs="unbounded"/>
            <xs:element minOccurs="0" ref="csig:OtherRequestInfo"/>
        </xs:sequence>
        <xs:attribute name="Version" type="xs:string" use="optional" default="1.1"/>
    </xs:complexType>
]]></programlisting>
            </para>
            <section id="CertRequestPropertiesType">
                <title>Type CertRequestPropertiesType</title>
                <para>The <emphasis role="bold">CertRequestPropertiesType</emphasis> complex type is
                    used to specify requested properties of the signature certificate that is
                    associated with the generated signature.</para>
                <para>The <emphasis role="bold">CertRequestPropertiesType</emphasis> complex type
                    has the following attributes and elements:</para>
                <glosslist>
                    <glossentry>
                        <glossterm><literal>CertType</literal> [Default "PKC"]</glossterm>
                        <glossdef>
                            <para>An enumeration of certificate types, default "PKC". The supported
                                values are "PKC", "QC" and "QC/SSCD". "QC" means that the
                                certificate is requested to be a Qualified Certificate according to
                                legal definitions in national law governing the issuer. "QC/SSCD"
                                means a Qualified Certificate where the private key is declared to
                                be residing within a Secure Signature Creation Device according to
                                national law. "PKC" (Public Key Certificate) means a certificate
                                that is not a Qualified Certificate.</para>
                        </glossdef>
                    </glossentry>
                    <glossentry>
                        <glossterm><literal>&lt;saml:AuthnContextClassRef></literal>
                            [Optional]</glossterm>
                        <glossdef>
                            <para>A URI identifying the requested level of assurance that
                                authentication of the signature certificate subject MUST comply with
                                in order to complete signing and certificate issuance. A Signing
                                Service MUST NOT issue signature certificates and generate the
                                requested signature unless the authentication process used to
                                authenticate the requested signer meets the requested level of
                                assurance expressed in this element. If this element is absent, the
                                locally configured policy of the Signing Service is assumed.</para>
                        </glossdef>
                    </glossentry>
                    <glossentry>
                        <glossterm><literal>&lt;RequestedCertAttributes></literal>
                            [Optional]</glossterm>
                        <glossdef>
                            <para>Element holding a SAML Entity ID of an Attribute Authority that
                                MAY be used to obtain an attribute value for the requested
                                attribute. The EntityID value is specified using the <emphasis
                                    role="bold">saml:NameIDType</emphasis> complex type and MUST
                                include a <literal>Format</literal> attribute with the value
                                    <literal>urn:oasis:names:tc:SAML:2.0:nameid-format:entity</literal>.</para>
                        </glossdef>
                    </glossentry>
                    <glossentry>
                        <glossterm><literal>&lt;OtherProperties></literal> [Optional]</glossterm>
                        <glossdef>
                            <para>Other requested properties of the signature certificate.</para>
                        </glossdef>
                    </glossentry>
                </glosslist>
                <para>The following schema fragment defines the <emphasis role="bold"
                        >CertRequestPropertiesType</emphasis> complex type:</para>
                <programlisting><![CDATA[
    <xs:complexType name="CertRequestPropertiesType">
        <xs:sequence>
            <xs:element minOccurs="0" ref="saml:AuthnContextClassRef"/>
            <xs:element minOccurs="0" ref="csig:RequestedCertAttributes"/>
            <xs:element minOccurs="0" ref="csig:OtherProperties"/>
        </xs:sequence>
        <xs:attribute default="PKC" name="CertType">
            <xs:simpleType>
                <xs:restriction base="xs:string">
                    <xs:enumeration value="PKC"/>
                    <xs:enumeration value="QC"/>
                    <xs:enumeration value="QC/SSCD"/>
                </xs:restriction>
            </xs:simpleType>
        </xs:attribute>
    </xs:complexType>

    <xs:element name="RequestedCertAttributes"
        type="csig:RequestedAttributesType"/>
    <xs:element name="OtherProperties" type="csig:AnyType"/>
]]></programlisting>
                <section id="requestedAttributesType">
                    <title>Type RequestedAttributesType</title>
                    <para>The <emphasis role="bold">RequestedAttributesType</emphasis> complex type
                        is used to represent requests for subject attributes in a signer certificate
                        that is associated with the signer of the generated signature as a result of
                        the sign request. This protocol is designed to accommodate the scenario
                        where the Signing Service generates the signer key and the signer
                        certificate at the time of signing and where the Signing Service collects
                        the user's attributes from a SAML assertion. However, this element can also
                        be used as a requirement for attributes in existing certificates, where the
                        Signing Service can determine if the existing signing certificate matches
                        the requirements of the requesting service.</para>
                    <para>The <emphasis role="bold">RequestedAttributesType</emphasis> has the
                        following element:<glosslist>
                            <glossentry>
                                <glossterm><literal>&lt;RequestedCertAttribute></literal> [One or
                                    More]</glossterm>
                                <glossdef>
                                    <para>Information of type <emphasis role="bold"
                                            >MappedAttributeType</emphasis> about a requested
                                        certificate attribute.</para>
                                </glossdef>
                            </glossentry>
                        </glosslist></para>
                    <para>The following schema fragment defines the <emphasis role="bold"
                            >RequestedAttributesType</emphasis> complex type:</para>
                    <para>
                        <programlisting><![CDATA[
    <xs:complexType name="RequestedAttributesType">
        <xs:sequence>
            <xs:element maxOccurs="unbounded" minOccurs="1"
                name="RequestedCertAttribute"
                type="csig:MappedAttributeType"/>
        </xs:sequence>
    </xs:complexType>
]]></programlisting>
                    </para>
                    <para>The <emphasis role="bold">MappedAttributeType</emphasis> complex type has
                        the following elements and attributes:</para>
                    <glosslist>
                        <glossentry>
                            <glossterm><literal>CertAttributeRef</literal> [Optional]</glossterm>
                            <glossdef>
                                <para>A reference to the certificate attribute or name type where
                                    the requester wants to store this attribute value. The
                                    information in this attribute depends on the selected
                                        <literal>CertNameType</literal> attribute value. If the
                                        <literal>CertNameType</literal> is "<emphasis role="bold"
                                        >rdn</emphasis>" or "<emphasis role="bold">sda</emphasis>",
                                    then this attribute MUST contain a string representation of an
                                    object identifier (OID). If the <literal>CertNameType</literal>
                                    is "<emphasis role="bold">san</emphasis>" (Subject Alternative
                                    Name) and the target name is a GeneralName, then this attribute
                                    MUST hold a string representation of the tag value of the target
                                    GeneralName type, e.g. "1" for rfc822Name (E-mail) or "2" for
                                    dNSName. If the <literal>CertNameType</literal> is "<emphasis
                                        role="bold">san</emphasis>" and the target name form is an
                                    OtherName, then this attribute value MUST include a string
                                    representation of the object identifier of the target OtherName
                                    form.</para>
                                <para>Representation of an OID as a string in this attribute MUST
                                    consist of a sequence of integers delimited by a dot. This
                                    string MUST not contain white space or line breaks. Example:
                                    "2.5.4.32". </para>
                            </glossdef>
                        </glossentry>
                        <glossentry>
                            <glossterm><literal>CertNameType</literal> [Optional]</glossterm>
                            <glossdef>
                                <para>An enumeration of the target name form for storing the
                                    associated SAML attribute value in the certificate. The
                                    available values are "rdn" for storing the attribute value as an
                                    attribute in a Relative Distinguished Name in the subject field
                                    of the certificate, "san" for storing the attribute value in a
                                    subject alternative name extension and "sda" for storing the
                                    attribute value in a subject directory attribute extension. The
                                    default value for this attribute is "rdn".</para>
                            </glossdef>
                        </glossentry>
                        <glossentry>
                            <glossterm><literal>FriendlyName</literal> [Optional]</glossterm>
                            <glossdef>
                                <para>An optional friendly name of the subject attribute, e.g.
                                    "givenName". Note that this name does not need to map to any
                                    particular naming convention and its value MUST NOT be used by
                                    the Signing Service for attribute type mapping. This name is
                                    present for display purposes only.</para>
                            </glossdef>
                        </glossentry>
                        <glossentry>
                            <glossterm><literal>DefaultValue</literal> [Optional]</glossterm>
                            <glossdef>
                                <para>An optional default value for the requested attribute. This
                                    value MAY be used by the Signing Service if no authoritative
                                    value for the attribute can be obtained when the Signing Service
                                    authenticates the user. This value MUST NOT be used by the
                                    Signing Service unless this value is consistent with a defined
                                    policy at the Signing Service. A typical valid use of this
                                    attribute is to hold a default countryName attribute value that
                                    matches a set of allowed countryName values. By accepting the
                                    default attribute value provided in this attribute, the Signing
                                    Service accept the requesting service as an authoritative source
                                    for this particular requested attribute.</para>
                            </glossdef>
                        </glossentry>
                        <glossentry>
                            <glossterm><literal>Required</literal> [Optional] (Default
                                false)</glossterm>
                            <glossdef>
                                <para>If this attribute is set to true, the Signing Service MUST
                                    ensure that the signing certificate contains a subject attribute
                                    of the requested type, or else the Signing Service MUST NOT
                                    generate the requested signature.</para>
                            </glossdef>
                        </glossentry>
                        <glossentry>
                            <glossterm><literal>&lt;AttributeAuthority></literal> [Zero or
                                More]</glossterm>
                            <glossdef>
                                <para>Element holding an Entity ID of an Attribute Authority that
                                    MAY be used to obtain an attribute value for the requested
                                    attribute. The EntityID value is specified using the <emphasis
                                        role="bold">saml:NameIDType</emphasis> complex type and MUST
                                    include a <literal>Format</literal> attribute with the value
                                        <literal>urn:oasis:names:tc:SAML:2.0:nameid-format:entity</literal>.</para>
                            </glossdef>
                        </glossentry>
                        <glossentry>
                            <glossterm><literal>&lt;SamlAttributeName></literal> [Zero or
                                More]</glossterm>
                            <glossdef>
                                <para>Element of type <emphasis role="bold"
                                        >PreferredSAMLAttributeNameType</emphasis> complex type
                                    holding a name of a SAML subject attribute that is allowed to
                                    provide the content value for the requested certificate
                                    attribute.</para>
                            </glossdef>
                        </glossentry>
                    </glosslist>
                    <para>The following schema fragment defines the <emphasis role="bold"
                            >MappedAttributeType</emphasis> complex type:</para>
                    <programlisting><![CDATA[
    <xs:complexType name="MappedAttributeType">
        <xs:sequence>
            <xs:element maxOccurs="unbounded" minOccurs="0"
                name="AttributeAuthority" type="saml:NameIDType"/>
            <xs:element maxOccurs="unbounded" minOccurs="0"
                name="SamlAttributeName"
                type="csig:PreferredSAMLAttributeNameType"/>
        </xs:sequence>
        <xs:attribute name="CertAttributeRef" type="xs:string" use="optional"/>
        <xs:attribute name="CertNameType" default="rdn" use="optional">
            <xs:simpleType>
                <xs:restriction base="xs:string">
                    <xs:enumeration value="rdn"/>
                    <xs:enumeration value="san"/>
                    <xs:enumeration value="sda"/>
                </xs:restriction>
            </xs:simpleType>
        </xs:attribute>
        <xs:attribute name="FriendlyName" type="xs:string"/>
        <xs:attribute name="DefaultValue" type="xs:string"/>
        <xs:attribute name="Required" type="xs:boolean" default="false"/>
    </xs:complexType>
]]></programlisting>
                    <para>The <emphasis role="bold">PreferredSAMLAttributeNameType</emphasis>
                        complex type holds a string value of a SAML attribute name. This attribute
                        name SHALL be mapped against attribute names in
                            <literal>&lt;saml:Attribute></literal> elements representing the subject
                        in a SAML assertion that is used to authenticate the signer. </para>
                    <para>The <emphasis role="bold">PreferredSAMLAttributeNameType</emphasis>
                        complex type has the following attribute:<glosslist>
                            <glossentry>
                                <glossterm><literal>Order</literal> [Optional]</glossterm>
                                <glossdef>
                                    <para>An integer specifying the order of preference of this SAML
                                        attribute. If more than one SAML attribute is listed, the
                                        SAML attribute with the lowest <literal>order</literal>
                                        integer value that is present as a subject attribute in the
                                        SAML assertion, SHALL be used. SAML attributes with an
                                        absent <literal>order</literal> attribute SHALL be treated
                                        as having an order value of 0. Multiple SAML attributes with
                                        an identical <literal>order</literal> attribute values SHALL
                                        be treated as having equal priority.</para>
                                </glossdef>
                            </glossentry>
                        </glosslist></para>
                    <para>The following schema fragment defines the <emphasis role="bold"
                            >PreferredSAMLAttributeNameType</emphasis> complex type:</para>
                    <para>
                        <programlisting><![CDATA[
    <xs:complexType name="PreferredSAMLAttributeNameType">
        <xs:simpleContent>
            <xs:extension base="xs:string">
                <xs:attribute name="Order" type="xs:int" default="0"/>
            </xs:extension>
        </xs:simpleContent>
    </xs:complexType>
]]></programlisting>
                    </para>
                </section>
            </section>
            <section id="SignMessageType">
                <title>Element &lt;SignMessage></title>
                <para>The <literal>&lt;SignMessage></literal> element holds a message to the signer
                    with information about what is being signed. The sign message is provided either
                    in plain text using the <literal>&lt;Message></literal> child element or as an
                    encrypted message using the <literal>&lt;EncryptedMessage></literal> child
                    element. This element's <emphasis role="bold">SignMessageType</emphasis> complex
                    type includes the following attributes and elements:</para>
                <glosslist>
                    <glossentry>
                        <glossterm><literal>MustShow</literal> [Optional] (Default
                                "<literal>false</literal>")</glossterm>
                        <glossdef>
                            <para>When this attribute is set to <literal>true</literal> then the
                                requested signature MUST NOT be created unless this message has been
                                displayed and accepted by the signer. The defalut is
                                    <literal>false</literal>.</para>
                        </glossdef>
                    </glossentry>
                    <glossentry>
                        <glossterm><literal>DisplayEntity</literal> [Optional] </glossterm>
                        <glossdef>
                            <para>The EntityID of the entity responsible for displaying the sign
                                message to the signer. When the sign message is encrypted, then this
                                entity is also the holder of the private decryption key necessary to
                                decrypt the sign message.</para>
                        </glossdef>
                    </glossentry>
                    <glossentry>
                        <glossterm><literal>MimeType</literal> [Optional] (Default
                                "<literal>text</literal>")</glossterm>
                        <glossdef>
                            <para>The mime type defining the message format. This is an enumeration
                                of the valid attribute values <literal>text</literal> (plain text),
                                    <literal>text/html</literal> (html) or
                                    <literal>text/markdown</literal> (markdown). This specification
                                does not specify any particular restrictions on the provided message
                                but it is RECOMMENDED that sign message content is restricted to a
                                limited set of valid tags and attributes, and that the display
                                entity performs filtering to enforce these restrictions before
                                displaying the message. The means through which parties agree on
                                such restrictions are outside the scope of this specification, but
                                one valid option to communicate such restrictions could be through
                                federation metadata. </para>
                        </glossdef>
                    </glossentry>
                    <glossentry>
                        <glossterm><literal>&lt;Message></literal> [Choice] </glossterm>
                        <glossdef>
                            <para>The base64 encoded sign message in unencrypted form. The message
                                MUST be encoded using UTF-8.</para>
                        </glossdef>
                    </glossentry>
                    <glossentry>
                        <glossterm><literal>&lt;EncryptedMessage></literal> [Choice] </glossterm>
                        <glossdef>
                            <para>An encrypted &lt;Mesage> element. Either a
                                    <literal>&lt;Message></literal> or an
                                    <literal>&lt;EncryptedMessage></literal> element MUST be
                                present.</para>
                        </glossdef>
                    </glossentry>
                </glosslist>
                <para>The following schema fragment defines the <literal>&lt;SignMessage></literal>
                    element and the <emphasis role="bold">SignMessageType</emphasis> complex
                    type:</para>
                <programlisting><![CDATA[
        <xs:complexType name="SignMessageType">
        <xs:choice>
            <xs:element ref="csig:Message"/>
            <xs:element ref="csig:EncryptedMessage"/>
        </xs:choice>
        <xs:attribute name="MustShow" type="xs:boolean" default="false"/>
        <xs:attribute name="DisplayEntity" type="xs:anyURI"/>
        <xs:attribute name="MimeType" default="text">
            <xs:simpleType>
                <xs:restriction base="xs:string">
                    <xs:enumeration value="text/html"/>
                    <xs:enumeration value="text"/>
                    <xs:enumeration value="text/markdown"/>
                </xs:restriction>
            </xs:simpleType>
        </xs:attribute>
        <xs:anyAttribute namespace="##other" processContents="lax"/>
    </xs:complexType>
    <xs:element name="Message" type="xs:base64Binary"/>
    <xs:element name="EncryptedMessage" type="saml:EncryptedElementType"/>
]]></programlisting>
            </section>
        </section>
        <section id="eidSignResponseExtension">
            <title>Element &lt;SignResponseExtension></title>
            <para>The <literal>&lt;SignResponseExtension></literal> element is an extension point
                that allows a requesting service to add essential sign response information to the
                sign response. When present, this element MUST be included in the
                    <literal>&lt;dss:OptionalOutputs></literal> element in a
                    <literal>&lt;dss:SignResponse></literal> element.</para>
            <para>This element's <emphasis role="bold">SignResponseExtensionType</emphasis> complex
                type includes the following attributes and elements:</para>
            <glosslist>
                <glossentry>
                    <glossterm><literal>Version</literal> [Optional] (Default
                            "<literal>1.1</literal>")</glossterm>
                    <glossdef>
                        <para>The version of this specification. If absent, the version value
                            defaults to "1.0". This attribute provides means for the receiving
                            service to determine the expected syntax of the response based on the
                            protocol version.</para>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm><literal>&lt;ResponseTime></literal> [Required]</glossterm>
                    <glossdef>
                        <para>The time when the sign response was created.</para>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm><literal>&lt;Request></literal> [Optional]</glossterm>
                    <glossdef>
                        <para>A base64 encoded signed <literal>&lt;dss:SignRequest></literal>
                            element that hods the request related to this sign response. This
                            element MUST be present if signing was successful.</para>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm><literal>&lt;SignerAssertionInfo></literal> [Optional]</glossterm>
                    <glossdef>
                        <para>An element of type <emphasis role="bold"
                                >SignerAssertionInfoType</emphasis> holding information about how
                            the signer was authenticated by the sign service as well as information
                            about subject attribute values present in the SAML assertion
                            authenticating the signer, which was incorporated into the signer
                            certificate. This element MUST be present if signing was
                            successful.</para>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm><literal>&lt;SignatureCertificateChain></literal>
                        [Optional]</glossterm>
                    <glossdef>
                        <para>An element of type <emphasis role="bold"
                                >CertificateChainType</emphasis> holding the signer certificate as
                            well as other certificates that may be used to validate the signature.
                            This element MUST be present if signing was successful and MUST contain
                            all certificates that are necessary to compile a complete and functional
                            signed document. Certificates in
                                <literal>&lt;SignatureCertificateChain></literal> MUST be provided
                            in sequence with the signature certificate first followed by any CA
                            certificates that can be used to verify the previous certificate in the
                            sequence, ending with a self-signed root certificate.</para>
                    </glossdef>
                </glossentry>
                <glossentry>
                    <glossterm><literal>&lt;OtherResponseInfo></literal> [Optional]</glossterm>
                    <glossdef>
                        <para>Optional sign response elements of type <emphasis role="bold"
                                >AnyType</emphasis>.</para>
                    </glossdef>
                </glossentry>
            </glosslist>
            <para>The following schema fragment defines the
                    <literal>&lt;SignResponseExtension></literal> element and the <emphasis
                    role="bold">SignResponseExtensionType</emphasis> complex type:</para>
            <para>
                <programlisting><![CDATA[
    <xs:element name="SignResponseExtension"
        type="csig:SignResponseExtensionType"/>
    <xs:complexType name="SignResponseExtensionType">
        <xs:sequence>
            <xs:element ref="csig:ResponseTime"/>
            <xs:element minOccurs="0" ref="csig:Request"/>
            <xs:element maxOccurs="1" minOccurs="0"
                ref="csig:SignerAssertionInfo"/>
            <xs:element minOccurs="0"
                ref="csig:SignatureCertificateChain"/>
            <xs:element minOccurs="0"
                ref="csig:OtherResponseInfo"/>
        </xs:sequence>
        <xs:attribute name="Version" type="xs:string"
            default="1.1"/>
    </xs:complexType>

    <xs:element name="ResponseTime" type="xs:dateTime"/>
    <xs:element name="Request" type="xs:base64Binary"/>
    <xs:element name="SignerAssertionInfo"
        type="csig:SignerAssertionInfoType"/>
    <xs:element name="SignatureCertificateChain"
        type="csig:CertificateChainType"/>
    <xs:element name="OtherResponseInfo" type="csig:AnyType"/>
]]></programlisting>
            </para>
            <section>
                <title>Type SignerAssertionInfoType</title>
                <para>The <emphasis role="bold">SignerAssertionInfoType</emphasis> complex type has
                    the following elements:</para>
                <glosslist>
                    <glossentry>
                        <glossterm><literal>&lt;ContextInfo></literal> [Required]</glossterm>
                        <glossdef>
                            <para>This element of type <emphasis role="bold"
                                    >ContextInfoType</emphasis> holds information about SAML
                                authentication context related to signer authentication through a
                                SAML assertion.</para>
                        </glossdef>
                    </glossentry>
                    <glossentry>
                        <glossterm><literal>&lt;saml:AttributeStatement></literal>
                            [Required]</glossterm>
                        <glossdef>
                            <para>This element of type <emphasis role="bold"
                                    >saml:AttributeStatementType</emphasis> (see <xref
                                    linkend="saml"/>) holds subject attributes obtained from the
                                SAML assertion used to authenticate the signer at the Signing
                                Service. For integrity reasons, this element SHOULD only provide
                                information about SAML attribute values that maps to subject
                                identity information in the signer's certificate.</para>
                        </glossdef>
                    </glossentry>
                    <glossentry>
                        <glossterm><literal>&lt;SamlAssertions></literal> [Zero or More]</glossterm>
                        <glossdef>
                            <para>Any number of relevant SAML assertions that was relevant for
                                authenticating the signer and signer's identity attributes at the
                                Signing Service.</para>
                        </glossdef>
                    </glossentry>
                </glosslist>
                <para>The following schema fragment defines the <emphasis role="bold"
                        >SignerAssertionInfoType</emphasis> complex type:</para>
                <para>
                    <programlisting><![CDATA[
    <xs:complexType name="SignerAssertionInfoType">
        <xs:sequence>
            <xs:element ref="csig:ContextInfo"/>
            <xs:element ref="saml:AttributeStatement"/>
            <xs:element minOccurs="0" ref="csig:SamlAssertions"/>
        </xs:sequence>
    </xs:complexType>

    <xs:element name="ContextInfo" type="csig:ContextInfoType"/>
    <xs:element name="SamlAssertions" type="csig:SAMLAssertionsType"/>
]]></programlisting>
                </para>
                <section>
                    <title>Type ContextInfoType</title>
                    <para>The <emphasis role="bold">ContextInfoType</emphasis> complex type has the
                        following elements:</para>
                    <glosslist>
                        <glossentry>
                            <glossterm><literal>&lt;IdentityProvider></literal>[Required]</glossterm>
                            <glossdef>
                                <para>The EntityID of the Identity Provider that authenticated the
                                    signer to the Signing Service.</para>
                            </glossdef>
                        </glossentry>
                        <glossentry>
                            <glossterm><literal>&lt;AuthenticationInstant></literal>
                                [Required]</glossterm>
                            <glossdef>
                                <para>The time when the Signing Service authenticated the
                                    signer.</para>
                            </glossdef>
                        </glossentry>
                        <glossentry>
                            <glossterm><literal>&lt;saml:AuthnContextClassRef></literal>
                                [Required]</glossterm>
                            <glossdef>
                                <para>A URI reference to the authentication context class (see <xref
                                        linkend="saml"/>).</para>
                            </glossdef>
                        </glossentry>
                        <glossentry>
                            <glossterm><literal>&lt;ServiceID></literal> [Optional]</glossterm>
                            <glossdef>
                                <para>An arbitrary identifier of the instance of the Signing Service
                                    that authenticated the signer.</para>
                            </glossdef>
                        </glossentry>
                        <glossentry>
                            <glossterm><literal>&lt;AuthType></literal> [Optional]</glossterm>
                            <glossdef>
                                <para>An arbitrary identifier of the service used by the Signing
                                    Service to authenticate the signer (e.g. "shibboleth".) </para>
                            </glossdef>
                        </glossentry>
                        <glossentry>
                            <glossterm><literal>&lt;AssertionRef></literal> [Optional]</glossterm>
                            <glossdef>
                                <para>A reference to the assertion used to identify the signer. This
                                    MAY be the <literal>ID</literal> attribute of a
                                        <literal>&lt;saml:Assertion></literal> element but MAY also
                                    be any other reference that can be used to locate and identify
                                    the assertion. </para>
                            </glossdef>
                        </glossentry>
                    </glosslist>
                    <para>
                        <programlisting><![CDATA[
    <xs:complexType name="ContextInfoType">
        <xs:sequence maxOccurs="1" minOccurs="0">
            <xs:element name="IdentityProvider" type="saml:NameIDType"/>
            <xs:element name="AuthenticationInstant" type="xs:dateTime"/>
            <xs:element ref="saml:AuthnContextClassRef"/>
            <xs:element minOccurs="0" name="ServiceID" type="xs:string"/>
            <xs:element minOccurs="0" name="AuthType" type="xs:string"/>
            <xs:element minOccurs="0" name="AssertionRef" type="xs:string"/>
        </xs:sequence>
    </xs:complexType>
]]></programlisting>
                    </para>
                </section>
                <section>
                    <title>Type SAMLAssertionsType</title>
                    <para>The <emphasis role="bold">SAMLAssertionsType</emphasis> is used to store
                        the bytes of an arbitrary number of SAML assertions (see <xref
                            linkend="saml"/>). This complex type has the following elements: </para>
                    <glosslist>
                        <glossentry>
                            <glossterm><literal>&lt;Assertion></literal>[One or More]</glossterm>
                            <glossdef>
                                <para>One or more SAML assertions represented by the bytes of each
                                    assertion. Assertions are stored as byte data to ensure that the
                                    signature on each assertion can be validated. Assertions stored
                                    in this element MUST retain its original canonical format so
                                    that any signature on the assertion can be validated.</para>
                            </glossdef>
                        </glossentry>
                    </glosslist>
                    <para>
                        <programlisting><![CDATA[
    <xs:complexType name="SAMLAssertionsType">
        <xs:sequence>
            <xs:element maxOccurs="unbounded" name="Assertion"
                type="xs:base64Binary"/>
        </xs:sequence>
    </xs:complexType>
]]></programlisting>
                    </para>
                </section>
            </section>
            <section>
                <title>Type CertificateChainType</title>
                <para>This complex type can be used to hold a sequence of X.509 certificates.
                    Certificates MUST be provided in sequence with the end-entity certificate first
                    in the sequence followed by any CA certificates that can be used to verify the
                    previous certificate in the sequence, ending with a self signed root
                    certificate.</para>
                <para>The <emphasis role="bold">CertificateChainType</emphasis> complex type has the
                    following elements:</para>
                <glosslist>
                    <glossentry>
                        <glossterm><literal>&lt;X509Certificate></literal> [One or More]</glossterm>
                        <glossdef>
                            <para>An X.509 certificate <xref linkend="rfc5280"/> that is part of a
                                certificate chain that can be used to verify the generated
                                signature. The certificate SHALL be represented as a base64Binary of
                                the DER encoded certificate.</para>
                        </glossdef>
                    </glossentry>
                </glosslist>
                <para>The following schema fragment defines the <emphasis role="bold"
                        >CertificateChainType</emphasis> complex type:</para>
                <para>
                    <programlisting><![CDATA[
    <xs:complexType name="CertificateChainType">
        <xs:sequence>
            <xs:element maxOccurs="unbounded" name="X509Certificate"
                type="xs:base64Binary"/>
        </xs:sequence>
    </xs:complexType>
]]></programlisting>
                </para>
            </section>
        </section>
    </section>
    <section>
        <title>Extensions to &lt;dss:InputDocuments> and &lt;dss:SignatureObject> </title>
        <para>This section defines elements that extends the
                <literal>&lt;dss:InputDocuments></literal> element of DSS sign requests and the
                <literal>&lt;dss:SignatureObject></literal> element of DSS sign responses by
            inclusion in their respective <literal>&lt;dss:Other></literal> element.</para>
        <section>
            <title>Element &lt;SignTasks></title>
            <para>The <literal>&lt;SignTasks></literal> element, when present, MUST appear either in
                the <literal>&lt;dss:Other></literal> element of the
                    <literal>&lt;dss:InputDocuments></literal> element of a sign request or in the
                    <literal>&lt;dss:Other></literal> element of the
                    <literal>&lt;dss:SignatureObject></literal> element of a sign response.</para>
            <para>This element holds information about sign tasks that are requested in a sign
                request and returned in a sign response. If information about a sign task is
                provided using this element in a sign request, then the corresponding signature
                result data MUST also be provided using this element in the sign response.</para>
            <para>This element's <emphasis role="bold">SignTasksType</emphasis> complex type
                includes the following attributes and elements:</para>
            <glosslist>
                <glossentry>
                    <glossterm><literal>&lt;SignTaskData></literal> [One or More]</glossterm>
                    <glossdef>
                        <para>Input and output data associated with a sign task. A request MAY
                            contain several instances of this element. When multiple instances of
                            this element are present in the request, this means that the Signing
                            Service is requested to generate multiple signatures (one for each
                                <literal>&lt;SignTaskData></literal> element) using the same signing
                            key and signature certificate. This allows batch signing of several
                            different documents in the same signing instance or creation of multiple
                            signatures on the same document such as signing XML content of a PDF
                            document with an XML signature, while signing the rest of the document
                            with a PDF signature.</para>
                    </glossdef>
                </glossentry>
            </glosslist>
            <para>The following schema fragment defines the <literal>&lt;SignTasks></literal>
                element and its <emphasis role="bold">SignTasksType</emphasis> complex type:</para>
            <programlisting><![CDATA[
    <xs:element name="SignTasks" type="csig:SignTasksType"/>
    <xs:complexType name="SignTasksType">
        <xs:sequence>
            <xs:element maxOccurs="unbounded" ref="csig:SignTaskData"/>
        </xs:sequence>
    </xs:complexType>

    <xs:element name="SignTaskData" type="csig:SignTaskDataType"/>
]]></programlisting>

            <section>
                <title>Element &lt;SignTaskData></title>
                <para>When present in a sign request, this element provides input data to a
                    signature generation process. When present in a sign response, this element
                    provides the corresponding signature result data. When a request provides input
                    data using this type of element, then an element of this type MUST also be used
                    to return the corresponding signature result data.</para>
                <para>This element's <emphasis role="bold">SignTaskDataType</emphasis> complex type
                    includes the following attributes and elements:</para>
                <glosslist>
                    <glossentry>
                        <glossterm><literal>SignTaskId</literal> [Optional]</glossterm>
                        <glossdef>
                            <para>An identifier of the signature task that is represented by this
                                element. If the request contains multiple instances of
                                    <literal>&lt;SignTaskData></literal> representing separate sign
                                tasks, then each instance of the element MUST have a
                                    <literal>SignatureId</literal> attribute value that is unique
                                among all sign tasks in the sign request. When this attribute is
                                present, the same attribute value MUST be returned in the
                                corresponding <literal>&lt;SignTaskData></literal> element in the
                                response that holds corresponding signature result data.</para>
                        </glossdef>
                    </glossentry>
                    <glossentry>
                        <glossterm><literal>SigType</literal> [Required]</glossterm>
                        <glossdef>
                            <para>Enumerated identifier of the type of signature format the
                                canonicalized signed information octets in the
                                    <literal>&lt;ToBeSignedBytes></literal> element are associated
                                with. This MUST be one of the enumerated values "XML", "PDF", "CMS"
                                of "ASiC".</para>
                        </glossdef>
                    </glossentry>
                    <glossentry>
                        <glossterm><literal>AdESType</literal> [Optional]</glossterm>
                        <glossdef>
                            <para>Specifies the type of AdES signature. BES means that the signing
                                certificate hash must be covered by the signature. EPES means that
                                the signing certificate hash and a signature policy identifier must
                                be covered by the signature.</para>
                        </glossdef>
                    </glossentry>
                    <glossentry>
                        <glossterm><literal>ProcessingRules</literal> [Optional]</glossterm>
                        <glossdef>
                            <para>A URI identifying one or more processing rules that the Signing
                                Service MUST apply when processing and using the provided signed
                                information octets. The Signing Service MUST NOT process and
                                complete the signature request if this attribute contains a URI that
                                is not recognized by the Signing Service. When this attribute is
                                present in the sign response, it represents a statement by the
                                Signing Service that the identified processing rule was successfully
                                executed.</para>
                        </glossdef>
                    </glossentry>
                    <glossentry>
                        <glossterm><literal>&lt;ToBeSignedBytes></literal> [Required]</glossterm>
                        <glossdef>
                            <para>The bytes to be hashed and signed when generating the requested
                                signature. For an XML signature this MUST be the canonicalized
                                octets of a <literal>&lt;dss:SignedInfo></literal> element. For a
                                PDF signature this MUST be the octets of the DER encoded SignedAttrs
                                value (signed attributes). If this data was altered by the signature
                                process, for example as a result of changing a signing time
                                attribute in PDF SignedAttrs, or as a result of adding a reference
                                to a hash of the signature certificate in an XAdES signature, the
                                altered data MUST be returned in the sign response using this
                                element.</para>
                        </glossdef>
                    </glossentry>
                    <glossentry>
                        <glossterm><literal>&lt;AdESObject></literal> [Optional]</glossterm>
                        <glossdef>
                            <para>An element of type <emphasis role="bold">AdESObjectType</emphasis>
                                complex type holding data to support generation of a signature
                                according to any of the ETSI Advanced Electronic Signature (AdES)
                                standard formats.</para>
                        </glossdef>
                    </glossentry>
                    <glossentry>
                        <glossterm><literal>&lt;Base64Signature></literal> [Optional]</glossterm>
                        <glossdef>
                            <para>The output signature value of the signature creation process
                                associated with this sign task. This element's optional
                                    <literal>Type</literal> attribute, if present, SHALL contain a
                                URI indicating the signature algorithm that was used to generate the
                                signature value.</para>
                        </glossdef>
                    </glossentry>
                    <glossentry>
                        <glossterm><literal>&lt;OtherSignTaskData></literal> [Optional]</glossterm>
                        <glossdef>
                            <para>Other input or output data elements associated with the sign
                                task.</para>
                        </glossdef>
                    </glossentry>
                </glosslist>
                <para>The following schema fragment defines the <literal>&lt;SignTaskData></literal>
                    element and its <emphasis role="bold">SignTaskDataType</emphasis> complex
                    type:</para>
                <programlisting><![CDATA[
    <xs:element name="SignTaskData" type="csig:SignTaskDataType"/>
    <xs:complexType name="SignTaskDataType">
        <xs:sequence>
            <xs:element ref="csig:ToBeSignedBytes"/>
            <xs:element maxOccurs="1" minOccurs="0" ref="csig:AdESObject"/>
            <xs:element minOccurs="0" ref="csig:Base64Signature"/>
            <xs:element minOccurs="0" ref="csig:OtherSignTaskData"/>
        </xs:sequence>
        <xs:attribute name="SignTaskId" type="xs:string"/>
        <xs:attribute name="SigType" use="required">
            <xs:simpleType>
                <xs:restriction base="xs:string">
                    <xs:enumeration value="XML"/>
                    <xs:enumeration value="PDF"/>
                    <xs:enumeration value="CMS"/>
                    <xs:enumeration value="ASiC"/>
                </xs:restriction>
            </xs:simpleType>
        </xs:attribute>
        <xs:attribute default="None" name="AdESType">
            <xs:simpleType>
                <xs:restriction base="xs:string">
                    <xs:enumeration value="None"/>
                    <xs:enumeration value="BES"/>
                    <xs:enumeration value="EPES"/>
                </xs:restriction>
            </xs:simpleType>
        </xs:attribute>
        <xs:attribute name="ProcessingRules" type="xs:anyURI" use="optional"/>
    </xs:complexType>

    <xs:element name="ToBeSignedBytes" type="xs:base64Binary"/>
    <xs:element name="AdESObject" type="csig:AdESObjectType"/>
    <xs:element name="Base64Signature" type="csig:Base64SignatureType"/>
    <xs:element name="OtherSignTaskData" type="csig:AnyType"/>
]]></programlisting>
                <section>
                    <title>Type AdESObjectType</title>
                    <para>The <emphasis role="bold">AdESObjectType</emphasis> complex type holds a
                        base64 encoded object that is referenced from the signature and which
                        content has to be modified as part of the certificate and signature
                        generation process. Handling of this data as in the signature generation
                        process MAY be affected by rules identifyed by the
                            <literal>ProcessingRules</literal>, <literal>SigType</literal> and
                            <literal>AdESType</literal> attributes of the parent
                            <literal>&lt;SignatureInputObjects></literal> elements. </para>
                    <para>This complex type has the following elements:<glosslist>
                            <glossentry>
                                <glossterm><literal>&lt;SignatureId></literal>
                                    [Optional]</glossterm>
                                <glossdef>
                                    <para>An optional identifier of the signature. When the
                                        requested signature is a XAdES signature, this is the value
                                        of the Id attribute of the
                                            <literal>&lt;ds:Signature></literal> element. of the
                                        resulting signature, which is used to construct the
                                            <literal>Target</literal> attribute of the
                                            <literal>&lt;xades:QualifyingProperties></literal>
                                        element. </para>
                                </glossdef>
                            </glossentry>
                            <glossentry>
                                <glossterm><literal>&lt;AdESObjectBytes></literal>
                                    [Optional]</glossterm>
                                <glossdef>
                                    <para>A base64 encoded object that is referenced from the
                                        signature and which content has to be modified as part of
                                        the certificate and signature generation process. The type
                                        of data in the base64 encoded bytes and the rules of
                                        handling of this data as in the signature generation process
                                        is determined through the
                                        <literal>ProcessingRules</literal>,
                                            <literal>SigType</literal> and
                                            <literal>AdESType</literal> attributes of the parent
                                            <literal>&lt;SignatureInputObjects></literal> elements.
                                        When the signature type is XAdES, then this is the bytes of
                                        the <literal>&lt;ds:Object></literal> element that holds the
                                            <literal>&lt;xades:QualifyingProperties></literal>
                                        element of the signature where the hash of the signature
                                        certificate will be placed.</para>
                                    <para>When this element is present in the request, it forms a
                                        base for construction of this object in the signature
                                        process. </para>
                                </glossdef>
                            </glossentry>
                            <glossentry>
                                <glossterm><literal>&lt;OtherAdESData></literal>
                                    [Optional]</glossterm>
                                <glossdef>
                                    <para>Other input data related to the AdES signature generation
                                        process.</para>
                                </glossdef>
                            </glossentry>
                        </glosslist></para>
                    <para>The following schema fragment defines the <emphasis role="bold"
                            >AdESObjectType</emphasis> complex type</para>
                    <programlisting><![CDATA[
    <xs:complexType name="AdESObjectType">
        <xs:sequence>
            <xs:element minOccurs="0" name="SignatureId" type="xs:string"/>
            <xs:element minOccurs="0" name="AdESObjectBytes"
                type="xs:base64Binary"/>
            <xs:element minOccurs="0" name="OtherAdESData" type="csig:AnyType"/>
        </xs:sequence>
    </xs:complexType>
]]></programlisting>
                </section>
            </section>
        </section>
    </section>
    <section>
        <title>Signing sign requests and responses</title>
        <para>This specification supports a scenario where a requesting service requests the signer
            to sign some data and where the same requesting service receives the signature from the
            Signing Service. In this scenario the requesting service acts as the presenter of
            information to be signed to the signer. Implementers of this specification MUST sign
            requests and responses for signature creation to protect against spoofing and
            substitution attacks. If a hash of the document to be signed is replaced in a sign
            request, the signer may end up signing something completely different than what the
            requesting service presented to the signer.</para>
        <para>When a <literal>&lt;dss:SignRequest></literal> is signed, the signature of that
            request MUST be placed as the last child element in the
                <literal>&lt;dss:OptionalInputs></literal> element. The Signing Service MUST check
            this signature and MUST check that the signature covers all data in the
                <literal>&lt;dss:SignRequest></literal> element (except for the signature
            itself).</para>
        <para>When a <literal>&lt;dss:SignResponse></literal> is signed, the signature of that
            response MUST be placed as the last child element in the
                <literal>&lt;dss:OptionalOutputs></literal> element. The Signing Service MUST check
            this signature and MUST check that the signature covers all data in the
                <literal>&lt;dss:SignResponse></literal> element (except for the signature
            itself)</para>
    </section>
    <appendix>
        <title>XML Schema</title>
        <para>This section provides the full XML Schema declaration for the DSS protocol extension
            defined in this document. In case of differences between the XML Schema in this appendix
            and XML Scema fragments in the sections above, the XML Schema in this appendix is the
            normative one.</para>
        <programlisting><![CDATA[
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified"
    xmlns:ds="http://www.w3.org/2000/09/xmldsig#"
    targetNamespace="http://id.elegnamnden.se/csig/1.1/dss-ext/ns"
    xmlns:saml="urn:oasis:names:tc:SAML:2.0:assertion"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:dss="urn:oasis:names:tc:dss:1.0:core:schema"
    xmlns:csig="http://id.elegnamnden.se/csig/1.1/dss-ext/ns">
    <xs:import namespace="urn:oasis:names:tc:SAML:2.0:assertion"
        schemaLocation="saml-schema-assertion-2.0.xsd"/>
    <xs:element name="SignRequestExtension" type="csig:SignRequestExtensionType">
        <xs:annotation>
            <xs:documentation>Extension to an OASIS DSS SignRequest, providing additional
information about a sign request. This element extends the
dss:OptionalInputs element of a dss:SignRequest.</xs:documentation>
        </xs:annotation>
    </xs:element>
    <xs:element name="SignResponseExtension" type="csig:SignResponseExtensionType">
        <xs:annotation>
            <xs:documentation>Extension to an OASIS DSS SignResponse, providing additional information
about a sign response. This element extends the dss:OptionalOutput element
of a dss:SignResponse.</xs:documentation>
        </xs:annotation>
    </xs:element>
    <xs:element name="SignTasks" type="csig:SignTasksType"/>
    <xs:element name="SignTaskData" type="csig:SignTaskDataType"/>
    <xs:element name="RequestTime" type="xs:dateTime">
        <xs:annotation>
            <xs:documentation>Time when the request was created</xs:documentation>
        </xs:annotation>
    </xs:element>
    <xs:element name="Signer" type="saml:AttributeStatementType">
        <xs:annotation>
            <xs:documentation>The identity of the signer expressed as a sequence of SAML attributes
using the AttributesType complex type.</xs:documentation>
        </xs:annotation>
    </xs:element>
    <xs:element name="IdentityProvider" type="saml:NameIDType">
        <xs:annotation>
            <xs:documentation>The SAML EntityID of the Identity Provider that MUST be used to
authenticate the signer before signing. The EntitID value is specified
using the saml:NameIDType complex type and MUST include a Format
attribute with the value urn:oasis:names:tc:SAML:2.0:nameid-format:entity.</xs:documentation>
        </xs:annotation>
    </xs:element>
    <xs:element name="SignRequester" type="saml:NameIDType">
        <xs:annotation>
            <xs:documentation>The SAML EntityID of the service that sends this request to the signing service.
The EntityID value is specified using the saml:NameIDType complex type and MUST
include a Format attribute with the value
urn:oasis:names:tc:SAML:2.0:nameid-format:entity.</xs:documentation>
        </xs:annotation>
    </xs:element>
    <xs:element name="SignService" type="saml:NameIDType">
        <xs:annotation>
            <xs:documentation>The SAML EntityID of the service to which this Sign Request is sent.
The EntityID value is specified using the saml:NameIDType complex type
and MUST include a Format attribute with the value
urn:oasis:names:tc:SAML:2.0:nameid-format:entity.</xs:documentation>
        </xs:annotation>
    </xs:element>
    <xs:element name="RequestedSignatureAlgorithm" type="xs:anyURI">
        <xs:annotation>
            <xs:documentation>An identifier of the signature algorithm the requesting service prefers
when generating the requested signature.</xs:documentation>
        </xs:annotation>
    </xs:element>
    <xs:element name="CertRequestProperties" type="csig:CertRequestPropertiesType">
        <xs:annotation>
            <xs:documentation>The requested properties of the signature certificate being issued by the
signature service.</xs:documentation>
        </xs:annotation>
    </xs:element>
    <xs:element name="RequestedCertAttributes" type="csig:RequestedAttributesType">
        <xs:annotation>
            <xs:documentation>An optional set of requested attributes that the requesting service prefers
or requires in the subject name of the generated signing certificate.</xs:documentation>
        </xs:annotation>
    </xs:element>
    <xs:element name="OtherProperties" type="csig:AnyType"/>
    <xs:element name="SignMessage" type="csig:SignMessageType">
        <xs:annotation>
            <xs:documentation>Sign message included as a choice of a Base64 encoded string or an ecrypted sign message.</xs:documentation>
        </xs:annotation>
    </xs:element>
    <xs:element name="Message" type="xs:base64Binary"/>
    <xs:element name="EncryptedMessage" type="saml:EncryptedElementType"/>
    <xs:element name="OtherRequestInfo" type="csig:AnyType">
        <xs:annotation>
            <xs:documentation>Any additional inputs to the request extension.</xs:documentation>
        </xs:annotation>
    </xs:element>
    <xs:element name="ResponseTime" type="xs:dateTime">
        <xs:annotation>
            <xs:documentation>The time when the sign response was created.</xs:documentation>
        </xs:annotation>
    </xs:element>
    <xs:element name="Request" type="xs:base64Binary">
        <xs:annotation>
            <xs:documentation>An element of type EncodedRequestType with base64Binary base type, holding
a representation of a complete and signed dss:SignRequest element that is
related to this sign response. This element MUST be present if signing was
successful.</xs:documentation>
        </xs:annotation>
    </xs:element>
    <xs:element name="SignerAssertionInfo" type="csig:SignerAssertionInfoType">
        <xs:annotation>
            <xs:documentation>An element of type SignerAssertionInfoType holding information about how
the signer was authenticated by the sign service as well as information
about subject attribute values present in the SAML assertion authenticating
the signer, which was incorporated into the signer certificate. This element
MUST be present if signing was successful.</xs:documentation>
        </xs:annotation>
    </xs:element>
    <xs:element name="ContextInfo" type="csig:ContextInfoType"/>
    <xs:element name="SamlAssertions" type="csig:SAMLAssertionsType"/>
    <xs:element name="SignatureCertificateChain" type="csig:CertificateChainType">
        <xs:annotation>
            <xs:documentation>An element of type CertificateChainType holding the signer certificate as
well as other certificates that may be used to validate the signature. This
element MUST be present if signing was successful and MUST contain all
certificate that are necessary to compile a complete and functional signed
document.</xs:documentation>
        </xs:annotation>
    </xs:element>
    <xs:element name="OtherResponseInfo" type="csig:AnyType">
        <xs:annotation>
            <xs:documentation>Optional sign response elements of type AnyType.</xs:documentation>
        </xs:annotation>
    </xs:element>
    <xs:element name="ToBeSignedBytes" type="xs:base64Binary">
        <xs:annotation>
            <xs:documentation>The octets that are hashed and signed when generating the signture. For
PDF and common modes of CMS this is the DER encoded SignedAttributess field.
For XML this is the canonicalized SignedInfo octets.</xs:documentation>
        </xs:annotation>
    </xs:element>
    <xs:element name="AdESObject" type="csig:AdESObjectType">
        <xs:annotation>
            <xs:documentation>Information in support of AdES signature creation</xs:documentation>
        </xs:annotation>
    </xs:element>
    <xs:element name="Base64Signature" type="csig:Base64SignatureType">
        <xs:annotation>
            <xs:documentation>Result signature bytes</xs:documentation>
        </xs:annotation>
    </xs:element>
    <xs:element name="OtherSignTaskData" type="csig:AnyType"/>
    <xs:complexType name="SignRequestExtensionType">
        <xs:sequence>
            <xs:element ref="csig:RequestTime"/>
            <xs:element ref="saml:Conditions">
                <xs:annotation>
                    <xs:documentation>Conditions that MUST be evaluated when assessing the validity of and/or
when using the Sign Request. See Section 2.5 of [SAML2.0]for additional
information on how to evaluate conditions.

This element MUST include the attributes NotBefore and NotOnOrAfter and
MUST include the element saml:AudienceRestriction which in turn MUST
contain one saml:Audience element, specifying the return URL for any
resulting Sign Response message.</xs:documentation>
                </xs:annotation>
            </xs:element>
            <xs:element ref="csig:Signer" minOccurs="0"/>
            <xs:element ref="csig:IdentityProvider"/>
            <xs:element ref="csig:SignRequester"/>
            <xs:element ref="csig:SignService"/>
            <xs:element minOccurs="0" ref="csig:RequestedSignatureAlgorithm"/>
            <xs:element minOccurs="0" ref="csig:CertRequestProperties"/>
            <xs:element minOccurs="0" ref="csig:SignMessage" maxOccurs="1"/>
            <xs:element minOccurs="0" ref="csig:OtherRequestInfo"/>
        </xs:sequence>
        <xs:attribute name="Version" type="xs:string" use="optional" default="1.1">
            <xs:annotation>
                <xs:documentation>The version of this specification. If absent, the version value defaults to "1.0".
This attribute provide means for the receiving service to determine the
expected syntax of the response based on protocol version.</xs:documentation>
            </xs:annotation>
        </xs:attribute>
    </xs:complexType>
    <xs:complexType name="SignResponseExtensionType">
        <xs:sequence>
            <xs:element ref="csig:ResponseTime"/>
            <xs:element minOccurs="0" ref="csig:Request"/>
            <xs:element maxOccurs="1" minOccurs="0" ref="csig:SignerAssertionInfo"/>
            <xs:element minOccurs="0" ref="csig:SignatureCertificateChain"/>
            <xs:element minOccurs="0" ref="csig:OtherResponseInfo"/>
        </xs:sequence>
        <xs:attribute name="Version" type="xs:string" default="1.1">
            <xs:annotation>
                <xs:documentation>The version of this specification. If absent, the version value defaults to "1.0".
This attribute provide means for the receiving service to determine the
expected syntax of the response based on protocol version.</xs:documentation>
            </xs:annotation>
        </xs:attribute>
    </xs:complexType>
    <xs:complexType name="CertificateChainType">
        <xs:sequence>
            <xs:element maxOccurs="unbounded" name="X509Certificate" type="xs:base64Binary"/>
        </xs:sequence>
    </xs:complexType>
    <xs:complexType name="MappedAttributeType">
        <xs:sequence>
            <xs:element maxOccurs="unbounded" minOccurs="0" name="AttributeAuthority"
                type="saml:NameIDType"/>
            <xs:element maxOccurs="unbounded" minOccurs="0" name="SamlAttributeName"
                type="csig:PreferredSAMLAttributeNameType"/>
        </xs:sequence>
        <xs:attribute name="CertAttributeRef" type="xs:string" use="optional"/>
        <xs:attribute name="CertNameType" default="rdn" use="optional">
            <xs:simpleType>
                <xs:restriction base="xs:string">
                    <xs:enumeration value="rdn"/>
                    <xs:enumeration value="san"/>
                    <xs:enumeration value="sda"/>
                </xs:restriction>
            </xs:simpleType>
        </xs:attribute>
        <xs:attribute name="FriendlyName" type="xs:string"/>
        <xs:attribute name="DefaultValue" type="xs:string"/>
        <xs:attribute name="Required" type="xs:boolean" default="false"/>
    </xs:complexType>
    <xs:complexType name="RequestedAttributesType">
        <xs:sequence>
            <xs:element maxOccurs="unbounded" minOccurs="1" name="RequestedCertAttribute"
                type="csig:MappedAttributeType"/>
        </xs:sequence>
    </xs:complexType>
    <xs:complexType name="AnyType">
        <xs:sequence>
            <xs:any processContents="lax" minOccurs="0" maxOccurs="unbounded"/>
        </xs:sequence>
    </xs:complexType>
    <xs:complexType name="SAMLAssertionsType">
        <xs:sequence>
            <xs:element maxOccurs="unbounded" name="Assertion" type="xs:base64Binary"/>
        </xs:sequence>
    </xs:complexType>
    <xs:complexType name="PreferredSAMLAttributeNameType">
        <xs:simpleContent>
            <xs:extension base="xs:string">
                <xs:attribute name="Order" type="xs:int" default="0"/>
            </xs:extension>
        </xs:simpleContent>
    </xs:complexType>
    <xs:complexType name="SignTasksType">
        <xs:sequence>
            <xs:element maxOccurs="unbounded" ref="csig:SignTaskData"/>
        </xs:sequence>
    </xs:complexType>
    <xs:complexType name="SignTaskDataType">
        <xs:sequence>
            <xs:element ref="csig:ToBeSignedBytes"/>
            <xs:element maxOccurs="1" minOccurs="0" ref="csig:AdESObject"/>
            <xs:element minOccurs="0" ref="csig:Base64Signature"/>
            <xs:element minOccurs="0" ref="csig:OtherSignTaskData"/>
        </xs:sequence>
        <xs:attribute name="SignTaskId" type="xs:string">
            <xs:annotation>
                <xs:documentation>A distinguishing id of this sign task which is used to distinguish between
multiple sign tasks in the same request</xs:documentation>
            </xs:annotation>
        </xs:attribute>
        <xs:attribute name="SigType" use="required">
            <xs:annotation>
                <xs:documentation>Enumeration of the type of signature the canonical signed information is
associated with.</xs:documentation>
            </xs:annotation>
            <xs:simpleType>
                <xs:restriction base="xs:string">
                    <xs:enumeration value="XML"/>
                    <xs:enumeration value="PDF"/>
                    <xs:enumeration value="CMS"/>
                    <xs:enumeration value="ASiC"/>
                </xs:restriction>
            </xs:simpleType>
        </xs:attribute>
        <xs:attribute default="None" name="AdESType">
            <xs:annotation>
                <xs:documentation>Specifies the type of AdES signature. BES means that the signing certificate
hash must be covered by the signature. EPES means that the signing
certificate hash and a signature policy identifier must be covered by
the signature.</xs:documentation>
            </xs:annotation>
            <xs:simpleType>
                <xs:restriction base="xs:string">
                    <xs:enumeration value="None"/>
                    <xs:enumeration value="BES"/>
                    <xs:enumeration value="EPES"/>
                </xs:restriction>
            </xs:simpleType>
        </xs:attribute>
        <xs:attribute name="ProcessingRules" type="xs:anyURI" use="optional">
            <xs:annotation>
                <xs:documentation>An identifier for processing rules that must be executed by the signature
service when processing data in this element.</xs:documentation>
            </xs:annotation>
        </xs:attribute>
    </xs:complexType>
    <xs:complexType name="AdESObjectType">
        <xs:sequence>
            <xs:element minOccurs="0" name="SignatureId" type="xs:string"/>
            <xs:element minOccurs="0" name="AdESObjectBytes" type="xs:base64Binary"/>
            <xs:element minOccurs="0" name="OtherAdESData" type="csig:AnyType"/>
        </xs:sequence>
    </xs:complexType>
    <xs:complexType name="CertRequestPropertiesType">
        <xs:sequence>
            <xs:element minOccurs="0" ref="saml:AuthnContextClassRef">
                <xs:annotation>
                    <xs:documentation>The a URI reference to the requested level of assurance with which the
certificate subject should be authenticated.</xs:documentation>
                </xs:annotation>
            </xs:element>
            <xs:element minOccurs="0" ref="csig:RequestedCertAttributes"/>
            <xs:element minOccurs="0" ref="csig:OtherProperties"/>
        </xs:sequence>
        <xs:attribute default="PKC" name="CertType">
            <xs:simpleType>
                <xs:restriction base="xs:string">
                    <xs:enumeration value="PKC"/>
                    <xs:enumeration value="QC"/>
                    <xs:enumeration value="QC/SSCD"/>
                </xs:restriction>
            </xs:simpleType>
        </xs:attribute>
    </xs:complexType>
    <xs:complexType name="SignerAssertionInfoType">
        <xs:sequence>
            <xs:element ref="csig:ContextInfo"/>
            <xs:element ref="saml:AttributeStatement"/>
            <xs:element minOccurs="0" ref="csig:SamlAssertions"/>
        </xs:sequence>
    </xs:complexType>
    <xs:complexType name="ContextInfoType">
        <xs:sequence maxOccurs="1" minOccurs="0">
            <xs:element name="IdentityProvider" type="saml:NameIDType"/>
            <xs:element name="AuthenticationInstant" type="xs:dateTime"/>
            <xs:element ref="saml:AuthnContextClassRef"/>
            <xs:element minOccurs="0" name="ServiceID" type="xs:string"/>
            <xs:element minOccurs="0" name="AuthType" type="xs:string"/>
            <xs:element minOccurs="0" name="AssertionRef" type="xs:string"/>
        </xs:sequence>
    </xs:complexType>
    <xs:complexType name="Base64SignatureType">
        <xs:simpleContent>
            <xs:extension base="xs:base64Binary">
                <xs:attribute name="Type" type="xs:anyURI"/>
            </xs:extension>
        </xs:simpleContent>
    </xs:complexType>
    <xs:complexType name="SignMessageType">
        <xs:choice>
            <xs:element ref="csig:Message"/>
            <xs:element ref="csig:EncryptedMessage"/>
        </xs:choice>
        <xs:attribute name="MustShow" type="xs:boolean" default="false"/>
        <xs:attribute name="DisplayEntity" type="xs:anyURI"/>
        <xs:attribute name="MimeType" default="text">
            <xs:simpleType>
                <xs:restriction base="xs:string">
                    <xs:enumeration value="text/html"/>
                    <xs:enumeration value="text"/>
                    <xs:enumeration value="text/markdown"/>
                </xs:restriction>
            </xs:simpleType>
        </xs:attribute>
        <xs:anyAttribute namespace="##other" processContents="lax"/>
    </xs:complexType>
</xs:schema>
]]></programlisting>
    </appendix>
</article>
<?nospell-end?>
