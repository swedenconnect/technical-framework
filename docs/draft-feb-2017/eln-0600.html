<!DOCTYPE html><html><head><meta charset="UTF-8"><title>ELN-0600 - Tekniskt ramverk - Svensk e-legitimation</title><style>/*By https://github.com/olvlvl at https://github.com/olvlvl/macdown/blob/8305c6d967c024f8dea6439db3d83121410e02bf/MacDown/Resources/Styles/GitHub3.css*/
body {
    color: #333;
    font: 16px/1.6 "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
    padding: 30px;
    margin: 0;
    word-wrap: break-word;
}

body > *:first-child {
    margin-top: 0 !important;
}

body > *:last-child {
    margin-bottom: 0 !important;
}

a {
    background: transparent;
    color: #4183c4;
    text-decoration: none;
}

a:active,
a:hover {
    outline: 0 none;
    text-decoration: underline;
}

abbr[title] {
    border-bottom: 1px dotted;
}

b,
strong {
    font-weight: bold;
}

dfn {
    font-style: italic;
}
h1 {
    font-size: 2em;
    margin: 0.67em 0;
}
mark {
    background: #ff0;
    color: #000;
}
small {
    font-size: 80%;
}
sub, sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}
sup {
    top: -0.5em;
}
sub {
    bottom: -0.25em;
}
img {
    border: 0 none;
}
svg:not(:root) {
    overflow: hidden;
}
figure {
    margin: 1em 40px;
}
hr {
    box-sizing: content-box;
    height: 0;
}

code,
kbd,
pre,
samp {
    font-family: monospace,monospace;
    font-size: 1em;
}

pre {
    overflow: auto;
    font: 12px Consolas,"Liberation Mono",Menlo,Courier,monospace;
    margin-bottom: 0;
    margin-top: 0;
}

.absent {
    color: #c00;
}

.anchor {
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    display: block;
    padding-right: 6px;
    padding-left: 30px;
    margin-left: -30px;
}

.anchor:focus {
    outline: none;
}

h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1em;
    margin-bottom: 16px;
    font-weight: bold;
    line-height: 1.4;
}

h1 .octicon-link,
h2 .octicon-link,
h3 .octicon-link,
h4 .octicon-link,
h5 .octicon-link,
h6 .octicon-link {
    display: none;
    color: #000;
    vertical-align: middle;
}

h1:hover .anchor,
h2:hover .anchor,
h3:hover .anchor,
h4:hover .anchor,
h5:hover .anchor,
h6:hover .anchor {
    padding-left: 8px;
    margin-left: -30px;
    line-height: 1;
    text-decoration: none;
}

h1:hover .anchor .octicon-link,
h2:hover .anchor .octicon-link,
h3:hover .anchor .octicon-link,
h4:hover .anchor .octicon-link,
h5:hover .anchor .octicon-link,
h6:hover .anchor .octicon-link {
    display: inline-block;
}

h1 tt,
h1 code,
h2 tt,
h2 code,
h3 tt,
h3 code,
h4 tt,
h4 code,
h5 tt,
h5 code,
h6 tt,
h6 code {
    font-size: inherit;
}

h1 {
    padding-bottom: 0.3em;
    font-size: 2.25em;
    line-height: 1.2;
    border-bottom: 1px solid #eee;
}

h2 {
    padding-bottom: 0.3em;
    font-size: 1.75em;
    line-height: 1.225;
    border-bottom: 1px solid #eee;
}

h3 {
    font-size: 1.5em;
    line-height: 1.43;
}

h4 {
    font-size: 1.25em;
}

h5 {
    font-size: 1em;
}

h6 {
    font-size: 1em;
    color: #777;
}

p,blockquote,
ul,ol,
dl,table,
pre {
    margin-top: 0;
    margin-bottom: 16px;
}

hr {
    height: 4px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
}

ul,
ol {
    padding-left: 2em;
}

ul.no-list,
ol.no-list {
    padding: 0;
    list-style-type: none;
}

ul ul,
ul ol,
ol ol,
ol ul {
    margin-top: 0;
    margin-bottom: 0;
}

li>p {
    margin-top: 16px;
}

dl {
    padding: 0;
}

dl dt {
    padding: 0;
    margin-top: 16px;
    font-size: 1em;
    font-style: italic;
    font-weight: bold;
}

dl dd {
    padding: 0 16px;
    margin-bottom: 16px;
}

blockquote {
    padding: 0 15px;
    color: #777;
    border-left: 4px solid #ddd;
}

blockquote>:first-child {
    margin-top: 0;
}

blockquote>:last-child {
    margin-bottom: 0;
}

table {
    display: block;
    width: 100%;
    overflow: auto;
    word-break: keep-all;
    border-collapse: collapse;
}

table th {
    font-weight: bold;
}

table th,
table td {
    padding: 6px 13px;
    border: 1px solid #ddd;
}

table tr {
    background-color: #fff;
    border-top: 1px solid #ccc;
}

table tr:nth-child(2n) {
    background-color: #f8f8f8;
}

img {
    max-width: 100%;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
}

span.frame {
    display: block;
    overflow: hidden;
}

span.frame>span {
    display: block;
    float: left;
    width: auto;
    padding: 7px;
    margin: 13px 0 0;
    overflow: hidden;
    border: 1px solid #ddd;
}

span.frame span img {
    display: block;
    float: left;
}

span.frame span span {
    display: block;
    padding: 5px 0 0;
    clear: both;
    color: #333;
}

span.align-center {
    display: block;
    overflow: hidden;
    clear: both;
}

span.align-center>span {
    display: block;
    margin: 13px auto 0;
    overflow: hidden;
    text-align: center;
}

span.align-center span img {
    margin: 0 auto;
    text-align: center;
}

span.align-right {
    display: block;
    overflow: hidden;
    clear: both;
}

span.align-right>span {
    display: block;
    margin: 13px 0 0;
    overflow: hidden;
    text-align: right;
}

span.align-right span img {
    margin: 0;
    text-align: right;
}

span.float-left {
    display: block;
    float: left;
    margin-right: 13px;
    overflow: hidden;
}

span.float-left span {
    margin: 13px 0 0;
}

span.float-right {
    display: block;
    float: right;
    margin-left: 13px;
    overflow: hidden;
}

span.float-right>span {
    display: block;
    margin: 13px auto 0;
    overflow: hidden;
    text-align: right;
}

code,tt {
    padding: 0.2em 0;
    margin: 0;
    font-size: 85%;
    background-color: rgba(0,0,0,0.04);
    border-radius: 3px;
}

code:before,
code:after,
tt:before,
tt:after {
    letter-spacing: -0.2em;
    content: "\00a0";
}

code br,
tt br {
    display: none;
}

del code {
    text-decoration: inherit;
}

pre>code {
    padding: 0;
    margin: 0;
    font-size: 100%;
    word-break: normal;
    white-space: pre;
    background: transparent;
    border: 0;
}

pre {
    padding: 16px;
    overflow: auto;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border-radius: 3px;
    word-wrap: normal;
}

pre code,
pre tt {
    display: inline;
    max-width: initial;
    padding: 0;
    margin: 0;
    overflow: initial;
    line-height: inherit;
    word-wrap: normal;
    background-color: transparent;
    border: 0;
}

pre code:before,
pre code:after,
pre tt:before,
pre tt:after {
    content: normal;
}

</style></head>
<body><p><img src="img/eln-logo.png"></img></p>

<h1>E-legitimationsnämndens Tekniska ramverk</h1>

<h3>Version: 1.5 - 2017-02-14</h3>

<h4><em>Utkast</em></h4>

<p><em>ELN-0600-v1.5</em></p>

<hr>

<h2>Innehållsförteckning</h2>

<ol>
<li><p><a href="#introduktion"><strong>Introduktion</strong></a></p>

<p>1.1. <a href="#oeversikt">Översikt</a></p>

<p>1.2. <a href="#tillitsramverk-och-saekerhetsnivaaer">Tillitsramverk och säkerhetsnivåer</a></p>

<p>1.3. <a href="#tjaenst-foer-insamling,-administration-och-publicering-av-metadata">Tjänst för insamling, administration och publicering av metadata</a></p>

<p>1.4. <a href="#anvisningstjaenst">Anvisningstjänst</a></p>

<p>1.5. <a href="#integration-hos-foerlitande-part">Integration hos förlitande part</a></p>

<p>1.6. <a href="#underskrift">Underskrift</a></p>

<p>1.7. <a href="#e-legitimationsnaemndens-tekniska-ramverk-och-eidas">E-legitimationsnämndens tekniska ramverk och eIDAS</a></p>

<p>1.7.1. <a href="#autentiseringar-med-utlaendska-e-legitimationer">Autentiseringar med utländska e-legitimationer</a></p>

<p>1.7.2. <a href="#underskrifter-med-utlaendska-e-legitimationer">Underskrifter med utländska e-legitimationer</a></p>

<p>1.7.3. <a href="#hantering-av-identiteter">Hantering av identiteter</a></p>

<p>1.7.4. <a href="#svenska-e-legitimationer-i-utlaendska-e-tjaenster">Svenska e-legitimationer i utländska e-tjänster</a></p></li>
<li><p><a href="#tekniska-specifikationer"><strong>Tekniska specifikationer</strong></a></p>

<p>2.1. <a href="#saml-profiler">SAML-profiler</a></p>

<p>2.1.1. <a href="#specifikationer-foer-anvisning-(discovery)">Specifikationer för anvisning (Discovery)</a></p>

<p>2.2. <a href="#specifikationer-foer-identitetsfederationer-som-foeljer-e-legitimationsnaemndens-tekniska-ramverk">Specifikationer för identitetsfederationer som följer E-legitimationsnämndens tekniska ramverk</a></p>

<p>2.2.1. <a href="#register-foer-identifierare-definierade-av-e-legitimationsnaemnden">Register för identifierare definierade av E-legitimationsnämnden</a></p>

<p>2.2.2. <a href="#attributspecifikation">Attributspecifikation</a></p>

<p>2.2.3. <a href="#specifikationer-av-entitetskategorier">Specifikationer av entitetskategorier</a></p>

<p>2.3. <a href="#specifikationer-foer-underskriftstjaenst">Specifikationer för Underskriftstjänst</a></p></li>
<li><p><a href="#referenslista"><strong>Referenslista</strong></a></p>

<p>3.1. <a href="#e-legitimationsnaemnden">E-legitimationsnämnden</a></p>

<p>3.2. <a href="#oevriga-referenser">Övriga referenser</a></p></li>
<li><p><a href="#aendringar-mellan-versioner"><strong>Ändringar mellan versioner</strong></a></p></li>
</ol>

<p><a name="introduktion"></a></p>

<h2>1. Introduktion</h2>

<p><a name="oeversikt"></a></p>

<h3>1.1. Översikt</h3>

<p>E-legitimationsnämndens tekniska ramverk är anpassat för
identitetsfederationer som baseras på SAML 2.0.</p>

<p>Förlitande parter erhåller identitetsintyg i ett standardiserat format
från en identitetsintygstjänst, i detta ramverk benämnd
legitimeringstjänst. Legitimeringstjänsterna tillhandahålls av, i
federationen, godkända leverantörer av intygstjänster.</p>

<p>Detta innebär också att e-tjänster som kräver underskrift inte längre
behöver anpassas efter olika användares e-legitimationer för att skapa
elektroniska underskrifter. Istället överlåter e-tjänsten detta till en
underskriftstjänst där användare med stöd av legitimering via
intygstjänsten ges möjlighet att underteckna elektroniska handlingar.</p>

<p>Inom federationen intar e-tjänster och motsvarande förlitande parter
rollen som Service Provider (SP) medan legitimeringstjänster som
utfärdar identitetsintyg intar rollen som Identity Provider (IdP) och
därmed den som autentiserar användaren, oavsett mot vilken e-tjänst som
användaren legitimerar sig.</p>

<p>För de fall där e-tjänsten behöver mer information om användaren t ex.
uppgift om juridisk behörighet, kan en fråga ställas till en
attributtjänst, Attribute Authority (AA), inom federationen, om sådan
relevant attributtjänst finns. Genom en attributsförfrågan kan
e-tjänsten erhålla nödvändig kompletterande information för att kunna
auktorisera användaren och ge tillgång till e-tjänsten eller
motsvarande.</p>

<p>Då såväl personidentitetsuppgifter som andra attribut kopplat till
användare tillhandahålls genom identitetsintyg och attributsintyg, kan
alla typer av e-legitimationer som förlitande part har avtal om och som
ingår i federationen användas för legitimering mot en e-tjänst som
kräver såväl personnummer/samordningsnummer som ytterligare information
om juridisk behörighet, även om e-legitimationen inte innehåller några
specifika personuppgifter (t.ex. koddosor för generering av
engångslösenord).</p>

<p><img src="img/sweeid-overview1.jpg" alt=""></p>

<p>Figur 1: <em>Illustration av kommunikationen mellan de olika tjänsterna inom
en identitetsfederation.</em></p>

<p><a name="tillitsramverk-och-saekerhetsnivaaer"></a></p>

<h3>1.2. Tillitsramverk och säkerhetsnivåer</h3>

<p>Grunden för vilken säkerhetsnivå som tillämpas när en användare
legitimerar sig är den tillitsnivå avseende e-legitimationen som
e-tjänsten kräver. För att dessa säkerhetsnivåer ska kunna vara
jämförbara inom ramen för federationen definieras fyra tillitsnivåer (1
– 4) i Tillitsramverket för Svensk e-legitimation [EidTillit] och tre
tillitsnivåer (låg, väsentlig, hög) i EU-förordningen eIDAS. Alla som
utfärdar identitetsintyg måste visa att hela den process som ligger till
grund för utfärdandet av identitetsintyg uppfyller kraven i den
efterfrågade tillitsnivån, detta innefattar bl.a.</p>

<ul>
<li><p>Krav på skapandet av identitetsintyget.</p></li>
<li><p>Krav på den elektroniska legitimeringen (autentiseringen).</p></li>
<li><p>Krav på utfärdandeprocessen.</p></li>
<li><p>Krav på själva e-legitimationen och dess användning.</p></li>
<li><p>Krav på utfärdaren av e-legitimationen.</p></li>
<li><p>Krav på fastställande av den e-legitimationssökandens identitet.</p></li>
</ul>

<p><a name="tjaenst-foer-insamling,-administration-och-publicering-av-metadata"></a></p>

<h3>1.3. Tjänst för insamling, administration och publicering av metadata</h3>

<p>En SAML-federation tillhandahåller information om federationens
deltagare genom s.k. metadata. Som deltagare i en federation räknas
såväl aktörer som levererar legitimerings- och attributtjänster i
federationen som förlitande parter, d.v.s. aktörer som konsumerar dessa
tjänster, t ex. e-tjänster.</p>

<p>Genom federationens metadata kan deltagare inhämta information om andra
deltagares tjänster, inklusive de uppgifter som krävs för ett säkert
informationsutbyte mellan deltagarna. Metadata måste hållas uppdaterat
av respektive part och överensstämma med avtalade förhållanden.</p>

<p>Det viktigaste syftet med metadata är att tillhandahålla de nycklar som
krävs för säker kommunikation och informationsutväxling mellan tjänster.
Utöver nycklar innehåller metadata även annan information som är viktig
för samverkan mellan tjänster t ex. adresser till funktioner som krävs,
information om tillitsnivåer, tjänstekategorier,
användargränssnittsinformation mm.</p>

<p>Identitetsfederationer förutsätter att legitimeringstjänster och
e-tjänster litar på varandra och därmed kan verifiera de signaturer som
används i kommunikationen mellan parterna. Rent tekniskt baseras denna
tillit på att respektive aktörer litar på varandras
signeringscertifikat.</p>

<p>En identitetsfederation definieras av ett register i XML-format som är
signerat med federationsoperatörens certifikat. Filen innehåller
information om identitetsfederationens medlemmar inklusive deras
certifikat. Eftersom filen med metadata är signerad räcker det med att
jämföra ett certifikat med dess motsvarighet i metadata. En
infrastruktur baserad på ett centralt federationsregister förutsätter
att registret uppdateras kontinuerligt samt att federationsmedlemmarna
alltid använder den senaste versionen av filen.</p>

<p><a name="anvisningstjaenst"></a></p>

<h3>1.4. Anvisningstjänst</h3>

<p>I en identitetsfederation är det möjligt att erbjuda och konsumera en
gemensam anvisningstjänst (Discovery Service), som listar vilka
legitimeringstjänster som är möjliga för användaren att välja mellan.
Syftet med en sådan anvisningstjänst är att avlasta de enskilda
e-tjänsterna som ingår i identitetsfederationen från att själva
implementera stöd för hur användare väljer legitimeringstjänst (eller
inloggningsmetod).</p>

<p>Genom att anvisningstjänsten finns tillgänglig inom
identitetsfederationen kan e-tjänster styra sina användare dit för val
av legitimeringstjänst. Anvisningstjänsten interagerar med användaren
som gör sitt val och användaren, tillsammans med dennes val, styrs
tillbaka till e-tjänsten som nu vet till vilken legitimeringstjänst
användaren ska skickas för legitimering.</p>

<p><a name="integration-hos-foerlitande-part"></a></p>

<h3>1.5. Integration hos förlitande part</h3>

<p>Förlitandeparter, t.ex. e-tjänster, integrerar mot legitimeringstjänster
genom standardiserade meddelanden och konsumerar identitetsintyg vilka
också har standardiserade format.</p>

<p>Detta tekniska ramverk bygger på interoperabilitetsprofilen ” SAML2int
Profile – SAML 2.0 Interoperability Profile”
[<a href="http://saml2int.org/profile/current/">SAML2Int</a>]. Profilen stöds av
ett flertal kommersiella produkter och Open Source-lösningar, vilket
underlättar integrationsarbetet hos e-tjänster.</p>

<p>Många e-tjänster använder fristående autentiseringslösningar vilket
innebär att en anpassning av integrationen för att följa
E-legitimationsnämndens tekniska ramverk får en begränsad påverkan på
e-tjänsten som sådan.</p>

<p><a name="underskrift"></a></p>

<h3>1.6. Underskrift</h3>

<p>Vid underskrift blir det med E-legitimationsnämndens tekniska ramverk
möjligt att använda olika typer av e-legitimationer, även sådana som
inte är certifikatbaserade, utan att speciella anpassningar i e-tjänsten
behövs. Orsaken är att det är det elektroniskt utställda
identitetsintyget (som används för identifiering av användare vid
underskrift) har samma format oavsett vilken typ av e-legitimation som
användaren använder.</p>

<p>En underskriftstjänst har som syfte att möjliggöra underskrift inom
identitetsfederationer som följer E-legitimationsnämndens tekniska
ramverk med stöd av alla typer av e-legitimationer som erbjuder
tillräcklig grad av säkerhet.</p>

<p>Genom att upphandla och införa en underskriftstjänst kan en förlitande
part som ingår i en sådan federation låta en användare skriva under en
elektronisk handling med stöd av den upphandlande underskriftstjänsten.
Användarens elektroniska signatur och tillhörande signeringscertifikat
skapas av underskriftstjänsten efter det att användaren accepterat att
skriva under genom att legitimera sig mot underskriftstjänsten.</p>

<p><a name="e-legitimationsnaemndens-tekniska-ramverk-och-eidas"></a></p>

<h3>1.7. E-legitimationsnämndens tekniska ramverk och eIDAS</h3>

<p>EU-förordningen (<a href="http://eur-lex.europa.eu/legal-content/SV/TXT/PDF/?uri=CELEX:32014R0910&amp;from=EN">910/2014</a>) om elektronisk identifiering och betrodda
tjänster, eIDAS, ställer krav på svenska offentliga organ att erkänna de
e-legitimationer som andra eIDAS-länder har anmält. Detta innebär att en
offentlig svensk e-tjänst baserat på vissa regler skall kunna acceptera
en inloggning som utförs med en e-legitimation utställd i ett annat
land.</p>

<p><a name="autentiseringar-med-utlaendska-e-legitimationer"></a></p>

<h4>1.7.1. Autentiseringar med utländska e-legitimationer</h4>

<p>De tekniska specifikationerna för eIDAS bygger, såsom
E-legitimationsnämndens tekniska ramverk, på SAML-standarder, och även
om likheterna är många finns även skillnader i dessa specifikationer. En
svensk e-tjänst ska dock inte förhålla sig direkt till eIDAS tekniska
specifikationer. Nedanstående bild illustrerar hur
E-legitimationsnämndens eIDAS-nod (<em>eIDAS-connector</em>) agerar som en brygga
mellan andra länder och en svensk federation då en person autentiseras
med en utländsk e-legitimation mot en svensk e-tjänst.
E-legitimationsnämndens eIDAS-nod följer E-legitimationsnämndens tekniska
ramverk.</p>

<p><img src="img/eidas-flow.jpg" alt=""></p>

<p>Flödet är enligt följande:</p>

<ol>
<li><p>En användare med en utländsk e-legitimation begär åtkomst till en
svensk e-tjänst (d.v.s., loggar in).</p></li>
<li><p>E-tjänsten låter användaren välja inloggningssätt med hjälp av en
anvisningstjänst. Ett val ”Foreign eID” visas upp, vilket användaren
i eIDAS-fallet väljer.</p></li>
<li><p>E-tjänsten skapar en legitimeringsbegäran enligt detta tekniska
ramverk och styr användaren till den svenska eIDAS-noden (<em>connector</em>)
som E-legitimationsnämnden ansvarar för. eIDAS-noden uppträder som
en legitimeringstjänst (<em>Identity Provider</em>) i federationen/-erna in
mot svenska förlitande parter vilket innebär att kommunikation med
denna tjänst utförs på samma sätt som mot övriga
legitimeringstjänster inom federationer som följer
E-legitimationsnämndens tekniska ramverk.</p></li>
<li><p>Den mottagna begäran behandlas och eIDAS-noden visar upp en valsida
där användaren väljer ”sitt land”<sup>1</sup>. Den svenska eIDAS-noden
omvandlar nu den mottagna legitimeringsbegäran till en
legitimeringsbegäran enligt eIDAS och användaren styrs till det
valda landets ”eIDAS Proxy-tjänst”.</p></li>
<li><p>Då legitimeringsbegäran mottas av den eIDAS-Proxy-tjänst för valt
land tar detta lands teknik för autentisering över. Inte alla länder
inom eIDAS använder SAML för autentisering, men om så var fallet i
vårt exempel skulle användaren styras vidare till en
legitimeringstjänst (<em>Identity Provider</em>), och innan dess kanske även
en anvisningstjänst för val av legitimeringstjänst.</p></li>
<li><p>Då en autentisering utförts skapas ett intyg (<em>Assertion</em>) enligt
eIDAS specifikationer. Detta intyg innehåller bl.a. eIDAS-specifika
attribut som identifierar användaren.</p></li>
<li><p>Detta intyg styrs nu vidare till den svenska eIDAS-noden. Noden tar
emot intyget och validerar dess korrekthet. I samband med att
intyget transformeras från eIDAS-format till ett intyg utformat
enligt E-legitimationsnämndens tekniska ramverk anropar noden också
en attributtjänst för att, om möjligt, givet eIDAS-attribut erhålla
attribut som stöds av den svenska e-tjänsten (t.ex. slå upp ett
svenskt person- eller samordningsnummer givet ett eIDAS
<em>PersonIdentifier</em>-attribut).</p></li>
<li><p>Slutligen postas ett intyg, på ett format som uppfyller
E-legitimationsnämndens tekniska ramverk, till e-tjänsten.</p></li>
<li><p>Förlitande part kompletterar eventuellt med ytterligare information
och avgör om användaren ska ges till åtkomst till tjänsten.</p></li>
</ol>

<p>Svenska e-tjänster behöver således endast stödja E-legitimationsnämndens
tekniska ramverk för att kunna hantera en autentisering utförd med en
europeisk e-legitimation. Dock måste e-tjänsten kunna hantera den
identitet som presenteras, vilket inte nödvändigtvis är ett personnummer
eller samordningsnummer. Det kan alltså hända att en e-tjänst
autentiserar en användare via eIDAS-ramverket, men att användarens
presenterade identitet inte går att använda hos e-tjänsten. Mer om detta
i kapitlet 1.7.3 nedan.</p>

<blockquote>
<p>[1]: Egentligen väljer användaren till vilken ”eIDAS Proxy-tjänst” som begäran ska skickas vidare till. Detta är beroende landstillhörigheten för användarens e-legitimationsutfärdare.</p>
</blockquote>

<p><a name="underskrifter-med-utlaendska-e-legitimationer"></a></p>

<h4>1.7.2. Underskrifter med utländska e-legitimationer</h4>

<p>Inom ramen för detta tekniska ramverk tillämpas en modell för
elektronisk underskrift som kallas federerad underskrift. En
serverbaserad underskriftstjänst knyts till e-tjänsten som i sin tur
begär underskrift. När en användare skriver under ett dokument skickar
e-tjänsten en underskriftsbegäran till underskriftstjänsten.
Underskriftstjänsten begär därefter att användaren legitimerar sig. I
samband med legitimeringen godkänner användaren underskriften.
Underskriftstjänsten skickar tillbaka uppgifter till e-tjänsten och
därefter lagras underskriftsuppgifterna kopplade till den handling som
har skrivits under.</p>

<p>Detta förfarande möjliggör att skriva under även med utländsk
e-legitimation då underskriftstjänsten kan välja att legitimera
användaren med utländsk e-legitimation i enlighet med förfarandet som
beskrivs ovan i avsnitt 1.7.1.</p>

<p>Vid en underskrift ansvarar i det fallet den svenska eIDAS-noden för att
användaren upplyses om att syftet med legitimeringen är att skriva under
ett dokument, vem som begärt underskrift samt med eventuell information
om vad som undertecknas. Först när användaren genom att legitimera sig
(för underskrift) utfärdas ett identitetsintyg, som skickas till
underskriftstjänsten och som i sin tur genererar underskriften.</p>

<p>I likhet med underskrift med stöd av legitimering med svenska
e-legitimationer så innebär underskrift med utländsk e-legitimation att
användarens av förlitande part registrerade identitet kan utgöras av
andra attribut än de som tillhandahålls av legitimeringstjänsten (t.ex.
anställningsnummer i stället för personnummer).</p>

<p><a name="hantering-av-identiteter"></a></p>

<h4>1.7.3. Hantering av identiteter</h4>

<p>Identitetsintyg från andra länder följer EU-gemensamma tekniska
specifikationer framtagna inom ramen för eIDAS-regelverket. Här
specificeras de attribut som varje land alltid måste skicka med för
fysiska personer såväl som för organisationer (”Minimum Dataset”, MDS).
Varje land måste skicka med en unik identifierare per e-legitimation som
representerar endast en fysisk person. Från vissa länder kommer dessa
identifierare vara unika och beständiga per person på motsvarande sätt
som t.ex. svenska personnummer, men dessa identifierare kan ha vitt
skilda sammansättningar och ha väldigt olika egenskaper. En egenskap som
kan variera är hur persistent en sådan identifierare är, d.v.s., om en
sådan identifierare är oförändrad under en persons livstid eller om den
ändras om personen exempelvis flyttar till en annan region, byter namn
eller bara byter e-legitimation. Från några länder (t.ex.
Storbritannien) kommer identifieraren att vara olika beroende på vilken
av landets e-legitimationer en användare för tillfället väljer att
använda.</p>

<p>För att förenkla hanteringen av användare i svenska e-tjänster så
genererar den svenska eIDAS-noden ett standardiserat ID-attribut för
användare som legitimerats med utländsk e-legitimation, ett s.k.
<em>provisional ID</em> (förkortat PRID). Dessutom skapas ett tillhörande
attribut som deklarerar vilken förväntad persistens, eller livslängd,
detta ID-attribut har. PRID-attributet genereras utifrån de
attributvärden som erhålls från den utländska legitimeringen enligt
specificerade metoder för respektive land. Varje kombination av land och
metod klassas med avseende på förväntad persistens, d.v.s., hur
sannolikt det är att en identitet ändras över tiden för samma person.
Detta gör det möjligt för svenska e-tjänster att anpassa kommunikationen
med användaren och proaktivt tillhandahålla funktioner som underlättar
för en användare vars identitet har ändrats, att återfå kontrollen över
sin information i e-tjänsten.</p>

<p>I vissa fall kan en person som legitimeras med en utländsk
e-legitimation även inneha ett svenskt personnummer eller ett styrkt
svenskt samordningsnummer. Det kan till exempel röra sig om en svensk
medborgare som flyttat utomlands och skaffat utländsk e-legitimation
eller en utländsk medborgare som har sådan anknytning till svenska
myndigheter att denne tilldelats ett styrkt samordningsnummer.</p>

<p>Det faktum att en person med utländsk e-legitimation innehar ett svenskt
personnummer eller samordningsnummer är normalt sett inte känt för den
utländska legitimeringstjänsten och denna information ingår därför inte
i identitetsintyg från landet där personen legitimeras. Den svenska
noden har däremot möjlighet att fråga en attributtjänst i Sverige<sup>2</sup> om
det finns ett registrerat personnummer eller samordningsnummer för den
legitimerade personen och kan, om så är fallet, påföra sådan information
i det identitetsintyg som skickas till e-tjänsten.</p>

<blockquote>
<p>[2]: Om en sådan kommer att finnas i enlighet med Skatteverkets förslag till regeringen i oktober 2016.</p>
</blockquote>

<p><a name="svenska-e-legitimationer-i-utlaendska-e-tjaenster"></a></p>

<h4>1.7.4. Svenska e-legitimationer i utländska e-tjänster</h4>

<p>Sverige har möjlighet att anmäla svenska e-legitimationer på tillitsnivå låg (low), väsentlig (substantial) och hög (high) enligt eIDAS. Det finns en politisk vilja i Sverige att låta innehavare av svenska e-legitimationer logga in i utländska tjänster.</p>

<p>En begäran om legitimering från en utländsk e-tjänst ställs till E-legitimationsnämndens eIDAS-nod (Proxy-tjänst) via en s.k. eIDAS-connector i e-tjänstens land. 
I den svenska eIDAS-noden väljer användaren med vilken svensk e-legitimation denne önskar autentisera sig, varpå en legitimeringsbegäran till den legitimeringstjänst (<em>Identity Provider</em>) som hanterar vald e-legitimation skickas. Denna begäran är utformad enligt E-legitimationsnämndens tekniska ramverk vilket innebär att en svensk legitimeringstjänst inte behöver förhålla sig till eIDAS tekniska specifikationer.</p>

<p>Användaren autentiseras hos den svenska legitimeringstjänsten och ett identitetsintyg ställs ut (enligt E-legitimationsnämndens tekniska ramverk). Detta intyg mottas av den svenska eIDAS Proxy-tjänsten och omvandlas till ett intyg enligt eIDAS specifikationer innan det skickas vidare till den utländska eIDAS-connectorn och därpå till den anropande e-tjänsten (<em>Service Provider</em>).</p>

<p>När en svensk e-legitimation används för inloggning utomlands har Sverige möjlighet att skicka med antingen det svenska personnumret som personidentitetsbegrepp, eller en pseudonym. Denna fråga och andra villkor för att använda svenska e-legitimationer i utländska e-tjänster utreds under 2017 i en offentlig utredning (<a href="http://www.sou.gov.se/n-201601-utredningen-om-effektiv-styrning-av-nationella-digitala-tjanster-i-en-samverkande-forvaltning/">N 2016:01 Utredningen om effektiv styrning av nationella digitala tjänster</a>), som ska redovisas till regeringen 2017-12-31.</p>

<p><a name="tekniska-specifikationer"></a></p>

<h2>2. Tekniska specifikationer</h2>

<p>Detta kapitel innehåller specifikationer och profiler för
identitetsfederationer som följer E-legitimationsnämndens tekniska
ramverk, och vissa kringliggande tjänster. Där inget annat nämns är
dessa dokument normativa för leverans av tjänster inom
identitetsfederationer som implementerar E-legitimationsnämndens
tekniska ramverk.</p>

<p><a name="saml-profiler"></a></p>

<h3>2.1. SAML-profiler</h3>

<p>Identitetsfederationer som följer detta tekniska ramverk är uppbyggda
kring följande SAML-profiler:</p>

<ul>
<li><p>Implementationsprofil – ”Kantara Initiative eGovernment
Implementation Profile of SAML 2.0”
[<a href="http://kantarainitiative.org/confluence/download/attachments/42140355/kantara-report-egov-saml2-profile-2.0.pdf">eGov2</a>].</p></li>
<li><p>Deploymentprofil – E-legitimationsnämndens ”Deployment Profile for
the Swedish eID Framework” [EidProfile]. Denna profil utgår från
”SAML2int profile – SAML 2.0 Interoperability Profile”
[<a href="http://saml2int.org/profile/current/">SAML2Int</a>].</p></li>
</ul>

<p><a name="specifikationer-foer-anvisning-(discovery)"></a></p>

<h4>2.1.1. Specifikationer för anvisning (Discovery)</h4>

<p>Den specifikation, [EidDiscovery], som gällt i tidigare versioner av
tekniskt ramverk är inte längre korrekt på grund av förändrade
förutsättningar. Specifikt beror detta på att den tidigare definitionen
att en e-legitimationsutfärdare endast kunde representeras med en
legitimeringstjänst inte längre gäller.</p>

<p>E-legitimationsnämnden planerar att utkomma med en uppdaterad
specifikation rörande anvisning i kommande utkast av tekniskt ramverk.</p>

<p><a name="specifikationer-foer-identitetsfederationer-som-foeljer-e-legitimationsnaemndens-tekniska-ramverk"></a></p>

<h3>2.2. Specifikationer för identitetsfederationer som följer E-legitimationsnämndens tekniska ramverk</h3>

<p><a name="register-foer-identifierare-definierade-av-e-legitimationsnaemnden"></a></p>

<h4>2.2.1. Register för identifierare definierade av E-legitimationsnämnden</h4>

<p>Implementering av en infrastruktur för Svensk e-legitimation kräver
olika former av identifierare för att representera objekt i
datastrukturer. Dokumentet ”Registry for identifiers assigned by the
Swedish e-identification board” [EidRegistry] definierar strukturen
för identifierare som tilldelats av E-legitimationsnämnden, samt ett
register över definierade identifierare.</p>

<p><a name="attributspecifikation"></a></p>

<h4>2.2.2. Attributspecifikation</h4>

<p>Dokumentet ”Attribute Specification for the Swedish eID Framework”
[EidAttributes] deklarerar de SAML attributprofiler som används inom
identitetsfederationer som följer tekniskt ramverk inklusive de som
ansluter till eIDAS via den svenska eIDAS-noden.</p>

<p>Dokumentet ”eIDAS Constructed Attributes Specification for the Swedish
eID Framework” [EidConstrAttributes] specificerar processer och regler
för hur ID-attribut konstrueras baserat på attribut som tas emot vid
legitimering mot eIDAS.</p>

<p><a name="specifikationer-av-entitetskategorier"></a></p>

<h4>2.2.3. Specifikationer av entitetskategorier</h4>

<p>Entitetskategorier (Entity Categories) används inom federationen för tre
syften:</p>

<ul>
<li><p>Service Entity Categories – Används i federationens metadata för att
representera e-tjänsters krav på tillitsnivåer och begärda attribut,
samt legitimeringstjänsters uppfyllande av tillitsnivåer och
leverans av attribut.</p></li>
<li><p>Service Property Categories – Används för att representera en viss
egenskap hos en tjänst.</p></li>
<li><p>Service Type Entity Categories – Används för att representera olika
tjänstetyper inom federationen.</p></li>
</ul>

<p>Dokumentet ”Entity Categories for the Swedish eID Framework”
[EidEntCat] specificerar de entitetskategorier som definieras av
E-legitimationsnämnden och beskriver dess betydelse.</p>

<p><a name="specifikationer-foer-underskriftstjaenst"></a></p>

<h3>2.3. Specifikationer för Underskriftstjänst</h3>

<p>Detta stycke innehåller referenser till de dokument vilka definierar
underskriftstjänster inom federationer som följer detta tekniska
ramverk.</p>

<p>Implementationsprofilen ”Implementation Profile for Using OASIS DSS in
Central Signing Services” [EidDSSProfile] specificerar en profil för
underskriftsbegäran och respons enligt OASIS standarden ”Digital
Signature Service Core Protocols, Elements, and Bindings”
[<a href="http://docs.oasis-open.org/dss/v1.0/oasis-dss-core-spec-v1.0-os.doc">DSS</a>],
och utökar denna med definitioner specificerade i ”DSS Extension for
Federated Central Signing Services” [EidDSSExt].</p>

<p>Vidare definieras en certifikatprofil ”Certificate profile for
certificates issued by Central Signing services” [EidCertProf] som
specificerar innehåll i signeringscertifikat. Denna profil tillämpar en
ny certifikatextension till stöd för signeringstjänsten, Authentication
Context Certificate Extension [AuthContext], vilken beskriver hur
”Authentication Context” representeras i X.509 certifikat.</p>

<p><a name="referenslista"></a></p>

<h2>3. Referenslista</h2>

<p><a name="e-legitimationsnaemnden"></a></p>

<h3>3.1. E-legitimationsnämnden</h3>

<p><strong>[EidTillit]</strong></p>

<blockquote>
<p>Tillitsramverk för Svensk E-legitimation.</p>
</blockquote>

<p><strong>[EidProfile]</strong></p>

<blockquote>
<p>Deployment Profile for the Swedish eID Framework.</p>
</blockquote>

<p><strong>[EidRegistry]</strong></p>

<blockquote>
<p>Registry for identifiers assigned by the Swedish e-identification
board.</p>
</blockquote>

<p><strong>[EidAttributes]</strong></p>

<blockquote>
<p>Attribute Specification for the Swedish eID Framework.</p>
</blockquote>

<p><strong>[EidConstrAttributes]</strong></p>

<blockquote>
<p>eIDAS Constructed Attributes Specification for the Swedish eID
Framework.</p>
</blockquote>

<p><strong>[EidEntCat]</strong></p>

<blockquote>
<p>Entity Categories for the Swedish eID Framework.</p>
</blockquote>

<p><strong>[EidDiscovery]</strong></p>

<blockquote>
<p>Discovery within the Swedish eID Framework. (Ej längre giltigt).</p>
</blockquote>

<p><strong>[EidDSSProfile]</strong></p>

<blockquote>
<p>Implementation Profile for Using OASIS DSS in Central Signing
Services.</p>
</blockquote>

<p><strong>[EidDSSExt]</strong></p>

<blockquote>
<p>DSS Extension for Federated Central Signing Services.</p>
</blockquote>

<p><strong>[EidCertProf]</strong></p>

<blockquote>
<p>Certificate profile for certificates issued by Central Signing
services.</p>
</blockquote>

<p><a name="oevriga-referenser"></a></p>

<h3>3.2. Övriga referenser</h3>

<p><strong>[eGov2]</strong></p>

<blockquote>
<p><a href="http://kantarainitiative.org/confluence/download/attachments/42140355/kantara-report-egov-saml2-profile-2.0.pdf">Kantara Initiative eGovernment Implementation Profile of SAML 2.0,
Version 2.0, June 11,
2010.</a></p>
</blockquote>

<p><strong>[SAML2Int]</strong></p>

<blockquote>
<p><a href="http://saml2int.org/profile/current/">SAML2int profile v0.2.1 – SAML 2.0 Interoperability
Profile</a>.</p>
</blockquote>

<p><strong>[IdpDisco]</strong></p>

<blockquote>
<p><a href="http://docs.oasis-open.org/security/saml/Post2.0/sstc-saml-idp-discovery.pdf">OASIS Committee Specification, Identity Provider Discovery Service
Protocol and Profile, March
2008.</a></p>
</blockquote>

<p><strong>[DSS]</strong></p>

<blockquote>
<p><a href="http://docs.oasis-open.org/dss/v1.0/oasis-dss-core-spec-v1.0-os.doc">OASIS Standard – Digital Signature Service Core Protocols, Elements,
and Bindings Version 1.0, April 11,
2007</a>.</p>
</blockquote>

<p><strong>[AuthContext]</strong></p>

<blockquote>
<p><a href="https://tools.ietf.org/html/rfc7773">RFC-7773: Authentication Context Certificate Extension</a>.</p>
</blockquote>

<p><a name="aendringar-mellan-versioner"></a></p>

<h2>4. Ändringar mellan versioner</h2>

<p><strong>Ändringar mellan version 1.4 och version 1.5:</strong></p>

<ul>
<li><p>Tillägg av avsnitt 1.7, om eIDAS.</p></li>
<li><p>Benämningen ”Tekniskt ramverk för Svensk e-legitimation” ersattes
med ”E-legitimationsnämndens tekniska ramverk” med avsikten att
reservera begreppet Svensk e-legitimation för kvalitetsmärkningen av
svenska e-legitimationer vilken är oberoende av detta tekniska
ramverk.</p></li>
<li><p>Referenser till tekniska specifikationer rörande anvisning i avsnitt
2.1.1 togs bort på grund av ändrade förutsättningar.</p></li>
</ul>

<p><strong>Ändringar mellan version 1.3 och version 1.4:</strong></p>

<ul>
<li><p>Tekniskt ramverk för Svensk e-legitimation bygger nu på en nyare
version av ”SAML2int Deployment Profile” (se
<a href="http://saml2int.org/profile/current/">http://saml2int.org/profile/current/</a>).</p></li>
<li><p>Specifikationen ”Authentication Context Classes for Levels of
Assurance for the Swedish eID Framework” är inte längre del av
tekniskt ramverk för Svensk e-legitimation. Dess tidigare syfte har
ersatts med användande av attribut (som definieras i
[EidAttributes] och [EidProfile]). I detta dokument utgår det
tidigare kapitlet 2.2.3, ”Identifierare och schema för
representation av tillitsnivåer”.</p></li>
<li><p>Specifikationen [EidDSSExt] vars tidigare namn var ”Eid2 DSS
Extension for SAML based Central Signing service” heter nu ”DSS
Extension for Federated Central Signing Services”.</p></li>
</ul>

<p><strong>Ändringar mellan version 1.2 och version 1.3:</strong></p>

<ul>
<li>Tagit bort avsnittet <em>Integrering med verksamhetsspecifika
federationer</em> (flyttas till vägledningar).</li>
</ul>

<p><strong>Ändringar mellan version 1.1 och version 1.2:</strong></p>

<ul>
<li>Genomgång av referenslistan. I övrigt inga förändringar.</li>
</ul>

<p><strong>Ändringar mellan version 1.0 och version 1.1:</strong></p>

<ul>
<li><p>Förtydliganden kring användande av entitetskategorier.</p></li>
<li><p>Tillägg av specifikationer för Underskriftstjänst.</p></li>
</ul>
</body>
</html>