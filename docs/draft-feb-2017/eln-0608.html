<!DOCTYPE html><html><head><meta charset="UTF-8"><title>ELN-0608 - Certificate Profile for Central Signing Services</title><style>/*By https://github.com/olvlvl at https://github.com/olvlvl/macdown/blob/8305c6d967c024f8dea6439db3d83121410e02bf/MacDown/Resources/Styles/GitHub3.css*/
body {
    color: #333;
    font: 16px/1.6 "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
    padding: 30px;
    margin: 0;
    word-wrap: break-word;
}

body > *:first-child {
    margin-top: 0 !important;
}

body > *:last-child {
    margin-bottom: 0 !important;
}

a {
    background: transparent;
    color: #4183c4;
    text-decoration: none;
}

a:active,
a:hover {
    outline: 0 none;
    text-decoration: underline;
}

abbr[title] {
    border-bottom: 1px dotted;
}

b,
strong {
    font-weight: bold;
}

dfn {
    font-style: italic;
}
h1 {
    font-size: 2em;
    margin: 0.67em 0;
}
mark {
    background: #ff0;
    color: #000;
}
small {
    font-size: 80%;
}
sub, sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}
sup {
    top: -0.5em;
}
sub {
    bottom: -0.25em;
}
img {
    border: 0 none;
}
svg:not(:root) {
    overflow: hidden;
}
figure {
    margin: 1em 40px;
}
hr {
    box-sizing: content-box;
    height: 0;
}

code,
kbd,
pre,
samp {
    font-family: monospace,monospace;
    font-size: 1em;
}

pre {
    overflow: auto;
    font: 12px Consolas,"Liberation Mono",Menlo,Courier,monospace;
    margin-bottom: 0;
    margin-top: 0;
}

.absent {
    color: #c00;
}

.anchor {
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    display: block;
    padding-right: 6px;
    padding-left: 30px;
    margin-left: -30px;
}

.anchor:focus {
    outline: none;
}

h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1em;
    margin-bottom: 16px;
    font-weight: bold;
    line-height: 1.4;
}

h1 .octicon-link,
h2 .octicon-link,
h3 .octicon-link,
h4 .octicon-link,
h5 .octicon-link,
h6 .octicon-link {
    display: none;
    color: #000;
    vertical-align: middle;
}

h1:hover .anchor,
h2:hover .anchor,
h3:hover .anchor,
h4:hover .anchor,
h5:hover .anchor,
h6:hover .anchor {
    padding-left: 8px;
    margin-left: -30px;
    line-height: 1;
    text-decoration: none;
}

h1:hover .anchor .octicon-link,
h2:hover .anchor .octicon-link,
h3:hover .anchor .octicon-link,
h4:hover .anchor .octicon-link,
h5:hover .anchor .octicon-link,
h6:hover .anchor .octicon-link {
    display: inline-block;
}

h1 tt,
h1 code,
h2 tt,
h2 code,
h3 tt,
h3 code,
h4 tt,
h4 code,
h5 tt,
h5 code,
h6 tt,
h6 code {
    font-size: inherit;
}

h1 {
    padding-bottom: 0.3em;
    font-size: 2.25em;
    line-height: 1.2;
    border-bottom: 1px solid #eee;
}

h2 {
    padding-bottom: 0.3em;
    font-size: 1.75em;
    line-height: 1.225;
    border-bottom: 1px solid #eee;
}

h3 {
    font-size: 1.5em;
    line-height: 1.43;
}

h4 {
    font-size: 1.25em;
}

h5 {
    font-size: 1em;
}

h6 {
    font-size: 1em;
    color: #777;
}

p,blockquote,
ul,ol,
dl,table,
pre {
    margin-top: 0;
    margin-bottom: 16px;
}

hr {
    height: 4px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
}

ul,
ol {
    padding-left: 2em;
}

ul.no-list,
ol.no-list {
    padding: 0;
    list-style-type: none;
}

ul ul,
ul ol,
ol ol,
ol ul {
    margin-top: 0;
    margin-bottom: 0;
}

li>p {
    margin-top: 16px;
}

dl {
    padding: 0;
}

dl dt {
    padding: 0;
    margin-top: 16px;
    font-size: 1em;
    font-style: italic;
    font-weight: bold;
}

dl dd {
    padding: 0 16px;
    margin-bottom: 16px;
}

blockquote {
    padding: 0 15px;
    color: #777;
    border-left: 4px solid #ddd;
}

blockquote>:first-child {
    margin-top: 0;
}

blockquote>:last-child {
    margin-bottom: 0;
}

table {
    display: block;
    width: 100%;
    overflow: auto;
    word-break: keep-all;
    border-collapse: collapse;
}

table th {
    font-weight: bold;
}

table th,
table td {
    padding: 6px 13px;
    border: 1px solid #ddd;
}

table tr {
    background-color: #fff;
    border-top: 1px solid #ccc;
}

table tr:nth-child(2n) {
    background-color: #f8f8f8;
}

img {
    max-width: 100%;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
}

span.frame {
    display: block;
    overflow: hidden;
}

span.frame>span {
    display: block;
    float: left;
    width: auto;
    padding: 7px;
    margin: 13px 0 0;
    overflow: hidden;
    border: 1px solid #ddd;
}

span.frame span img {
    display: block;
    float: left;
}

span.frame span span {
    display: block;
    padding: 5px 0 0;
    clear: both;
    color: #333;
}

span.align-center {
    display: block;
    overflow: hidden;
    clear: both;
}

span.align-center>span {
    display: block;
    margin: 13px auto 0;
    overflow: hidden;
    text-align: center;
}

span.align-center span img {
    margin: 0 auto;
    text-align: center;
}

span.align-right {
    display: block;
    overflow: hidden;
    clear: both;
}

span.align-right>span {
    display: block;
    margin: 13px 0 0;
    overflow: hidden;
    text-align: right;
}

span.align-right span img {
    margin: 0;
    text-align: right;
}

span.float-left {
    display: block;
    float: left;
    margin-right: 13px;
    overflow: hidden;
}

span.float-left span {
    margin: 13px 0 0;
}

span.float-right {
    display: block;
    float: right;
    margin-left: 13px;
    overflow: hidden;
}

span.float-right>span {
    display: block;
    margin: 13px auto 0;
    overflow: hidden;
    text-align: right;
}

code,tt {
    padding: 0.2em 0;
    margin: 0;
    font-size: 85%;
    background-color: rgba(0,0,0,0.04);
    border-radius: 3px;
}

code:before,
code:after,
tt:before,
tt:after {
    letter-spacing: -0.2em;
    content: "\00a0";
}

code br,
tt br {
    display: none;
}

del code {
    text-decoration: inherit;
}

pre>code {
    padding: 0;
    margin: 0;
    font-size: 100%;
    word-break: normal;
    white-space: pre;
    background: transparent;
    border: 0;
}

pre {
    padding: 16px;
    overflow: auto;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border-radius: 3px;
    word-wrap: normal;
}

pre code,
pre tt {
    display: inline;
    max-width: initial;
    padding: 0;
    margin: 0;
    overflow: initial;
    line-height: inherit;
    word-wrap: normal;
    background-color: transparent;
    border: 0;
}

pre code:before,
pre code:after,
pre tt:before,
pre tt:after {
    content: normal;
}

</style></head>
<body><p><img src="img/eln-logo.png"></img></p>

<h1>Certificate profile for certificates issued by Central Signing services</h1>

<h3>Version 1.0 - 2013-10-30</h3>

<p><em>ELN-0608-v1.0</em></p>

<hr>

<h2>Table of Contents</h2>

<ol>
<li><p><a href="#introduction"><strong>Introduction</strong></a></p>

<p>1.1. <a href="#requirement-key-words">Requirement key words</a></p>

<p>1.2. <a href="#xml-name-space-references">XML name space references</a></p>

<p>1.3. <a href="#structure">Structure</a></p></li>
<li><p><a href="#certificate-profile"><strong>Certificate Profile</strong></a></p>

<p>2.1. <a href="#standards">Standards</a></p>

<p>2.2. <a href="#qualified-and-pkc-certificates">Qualified and PKC Certificates</a></p>

<p>2.3. <a href="#certificate-content">Certificate content</a></p>

<p>2.3.1. <a href="#subject-attributes-and-name-forms">Subject attributes and name forms</a></p>

<p>2.3.2. <a href="#authentication-context-and-attribute-mapping">Authentication Context and Attribute mapping</a></p></li>
<li><p><a href="#normative-references"><strong>Normative References</strong></a></p></li>
</ol>

<p><a name="introduction"></a></p>

<h2>1. Introduction</h2>

<p>This document specifies a certificate profile for certificates issued by
a signature service within the infrastructure for “Svensk
E-legitimation”.</p>

<p><a name="requirement-key-words"></a></p>

<h3>1.1. Requirement key words</h3>

<p>The key words <strong>MUST</strong>, <strong>MUST</strong> <strong>NOT</strong>, <strong>REQUIRED</strong>, <strong>SHALL</strong>,
<strong>SHALL</strong> <strong>NOT</strong>, <strong>SHOULD</strong>, <strong>SHOULD</strong> <strong>NOT</strong>, <strong>RECOMMENDED</strong>,
<strong>MAY</strong>, and <strong>OPTIONAL</strong> are to be interpreted as described in
[<a href="#rfc2119">RFC2119</a>].</p>

<p>These keywords are capitalized when used to unambiguously specify
requirements over protocol features and behavior that affect the
interoperability and security of implementations. When these words are
not capitalized, they are meant in their natural-language sense.</p>

<p><a name="xml-name-space-references"></a></p>

<h3>1.2. XML name space references</h3>

<p>The prefix <strong>saci:</strong> stands for the SAML Authentication Context
Information XML Schema namespace
(<code>http://id.elegnamnden.se/auth-cont/1.0/saci</code>).</p>

<p><a name="structure"></a></p>

<h3>1.3. Structure</h3>

<p>This specification uses the following typographical conventions in text:
<code>&lt;Eid2Element&gt;</code>, <code>&lt;ns:ForeignElement&gt;</code>, <code>Attribute</code>, <strong>Datatype</strong>,
<code>OtherCode</code>.</p>

<p><a name="certificate-profile"></a></p>

<h2>2. Certificate Profile</h2>

<p><a name="standards"></a></p>

<h3>2.1. Standards</h3>

<p>The following standards provides normative requirements for this
certificate profile:</p>

<table>
<thead>
<tr>
<th>Standard</th>
<th>Function</th>
<th>Referens</th>
</tr>
</thead>

<tbody>
<tr>
<td>RFC 5280</td>
<td>Main certificate standard</td>
<td>[<a href="#rfc5280">RFC5280</a>]</td>
</tr>
<tr>
<td>RFC 3739</td>
<td>Main certificate profile for Qualified Certificates</td>
<td>[<a href="#rfc3739">RFC3739</a>]</td>
</tr>
<tr>
<td>EN 319 412-5</td>
<td>EU profile of RFC 3739 providing defined data structures for issuing Qualified Certificate in accordance with the EU electronic signature directive [EUSig].</td>
<td>[<a href="#eu-qc">EU-QC</a>]</td>
</tr>
<tr>
<td>TS 102 280</td>
<td>EU interoperability profile for certificates issued to Natural Persons.</td>
<td>[<a href="#eu-interop">EU-INTEROP</a>]</td>
</tr>
</tbody>
</table>

<p><a name="qualified-and-pkc-certificates"></a></p>

<h3>2.2. Qualified and PKC Certificates</h3>

<p>This profile supports both Qualified Certificates as well as
certificates that are not Qualified Certificates, here named PKC
certificates (Public Key Certificates).</p>

<p>The same profile requirements apply for both Qualified Certificates and
for PKC certificates unless a requirement is explicitly related to only
Qualified Certificates.</p>

<p><a name="certificate-content"></a></p>

<h3>2.3. Certificate content</h3>

<p>All certificates SHALL be fully compliant with  [<a href="#rfc5280">RFC5280</a>], [<a href="#rfc3739">RFC3739</a>]
and [<a href="#eu-interop">EU-INTEROP</a>]. All Qualified Certificates SHALL also be fully
compliant with [<a href="#eu-qc">EU-QC</a>].</p>

<p>Qualified Certificates SHALL implement the “Statement regarding location
of Policy Disclosure Statements” (PDS) as specified in section 5.2.4 of
[<a href="#eu-qc">EU-QC</a>].</p>

<p><a name="subject-attributes-and-name-forms"></a></p>

<h4>2.3.1. Subject attributes and name forms</h4>

<p>Subject name attributes and other name forms in the certificate SHALL
comply with [<a href="#rfc3739">RFC3739</a>].</p>

<p>The following specific certificate subject name conventions SHALL be
met:</p>

<table>
<thead>
<tr>
<th>Subject data</th>
<th>Requirement</th>
</tr>
</thead>

<tbody>
<tr>
<td>Swedish “personnummer”</td>
<td>Swedish “personnummer” obtained from a SAML assertion using the attribute with OID 1.2.752.29.4.13, SHALL be stored in a serialNumber attribute (OID 2.5.4.5) in the subject field. The data SHALL be composed according to [<a href="#skv704">SKV704</a>]</td>
</tr>
<tr>
<td>Swedish “samordningsnummer”</td>
<td>Swedish “samordningsnummer” obtained from a SAML assertion using the attribute with OID 1.2.752.29.4.13, SHALL be stored in a serialNumber attribute (OID 2.5.4.5) in the subject field. The data SHALL be composed according to [<a href="#skv707">SKV707</a>].</td>
</tr>
<tr>
<td>E-mail address</td>
<td>E-mail address, when present, SHALL be stored in a Subject Alternative Name extension as an rfc822Name.</td>
</tr>
</tbody>
</table>

<p><a name="authentication-context-and-attribute-mapping"></a></p>

<h4>2.3.2. Authentication Context and Attribute mapping</h4>

<p>Certificates MUST include an <code>AuthContextExtension</code> according to
[<a href="#authcont">AuthCont</a>]. This extension SHALL include one SAML Authentication
Context Information element identified by the XML schema name space
identifier:</p>

<blockquote>
<p><code>http://id.elegnamnden.se/auth-cont/1.0/saci</code></p>
</blockquote>

<p>The <code>&lt;saci:SAMLAuthContext&gt;</code> element SHALL contain both an
<code>&lt;saci:AuthContextInfo&gt;</code> element as well as an
<code>&lt;saci:IdAttributes&gt;</code> element.</p>

<p>The <code>&lt;saci:IdAttributes&gt;</code> element SHALL contain one
<code>&lt;saci:AttributeMapping&gt;</code> element for each subject attribute or
other name form that was obtained from a SAML attribute in the SAML
assertion used to authenticate the signer as part of the signature
creation process. Each <code>&lt;saci:AttributeMapping&gt;</code> element SHALL
provide the <code>&lt;saml:AttributeValue&gt;</code> that were obtained from the SAML
assertion.</p>

<p><a name="normative-references"></a></p>

<h2>3. Normative References</h2>

<p><a name="rfc2119"></a><strong>[RFC2119]</strong></p>

<blockquote>
<p><a href="http://www.ietf.org/rfc/rfc2119.txt">Bradner, S., Key words for use in RFCs to Indicate Requirement
Levels, March 1997.</a></p>
</blockquote>

<p><a name="rfc3739"></a><strong>[RFC3739]</strong></p>

<blockquote>
<p>Santesson, S., Nystrom, M., and T. Polk, <q>Internet X.509 Public Key
Infrastructure: Qualified Certificates Profile</q>, RFC\03739, March
2004.</p>
</blockquote>

<p><a name="rfc5280"></a><strong>[RFC5280]</strong></p>

<blockquote>
<p>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and
W. Polk, <q>Internet X.509 Public Key Infrastructure Certificate and
Certificate Revocation List (CRL) Profile</q>, RFC\05280, May 2008.</p>
</blockquote>

<p><a name="eu-qc"></a><strong>[EU-QC]</strong></p>

<blockquote>
<p>“Electronic Signatures and Infrastructures (ESI); Profiles for Trust
Service Providers issuing certificates; Part 5: Extension for
Qualified Certificate profile”, ETSI TS 319 412-5 V1.1.1, Jan 2013.</p>
</blockquote>

<p><a name="eu-interop"></a><strong>[EU-INTEROP]</strong></p>

<blockquote>
<p>“X.509 V.3 Certificate Profile for Certificates Issued to Natural
Persons”, ETSI TS 102 280 V1.1.1, March 2004.</p>
</blockquote>

<p><a name="authcont"></a><strong>[AuthCont]</strong></p>

<blockquote>
<p>Authentication Context Certificate Extension
(<a href="http://tools.ietf.org/html/draft-santesson-auth-context-extension">http://tools.ietf.org/html/draft-santesson-auth-context-extension</a>)</p>
</blockquote>

<p><a name="skv704"></a><strong>[SKV704]</strong></p>

<blockquote>
<p><a href="http://www.skatteverket.se/download/18.1e6d5f87115319ffba380001857/70408.pdf">Skatteverket, SKV 704 utgåva 8, Personnummer, September
2007.</a></p>
</blockquote>

<p><a name="skv707"></a><strong>[SKV707]</strong></p>

<blockquote>
<p><a href="http://www.skatteverket.se/download/18.3dfca4f410f4fc63c86800016382/70702.pdf">Skatteverket, SKV 707 utgåva 2, Samordningsnummer, October
2006.</a></p>
</blockquote>
</body>
</html>