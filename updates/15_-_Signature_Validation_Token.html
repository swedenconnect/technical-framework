<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Signature Validation Token</title>
    <link type="text/css" rel="stylesheet" href="assets/css/github-markdown.css">
    <link type="text/css" rel="stylesheet" href="assets/css/pilcrow.css">
    <link type="text/css" rel="stylesheet" href="assets/css/eln-portrait.css" media="print" >
    <link type="text/css" rel="stylesheet" href="assets/css/eln-custom.css" media="print" >
  </head>
  <body>
    <article class="markdown-body"><p>
<img align="left" src="img/sweden-connect.png"></img>
<img align="right" src="img/digg_centered.png"></img>
</p>
<p>
<img align="center" src="img/transparent.png"></img>
</p>
<p>
<img align="center" src="img/transparent.png"></img>
</p>


<h1 id="signature-validation-token">Signature Validation Token</h1>
<h3 id="version-1.0---2020-03-12---*draft-version*">Version 1.0 - 2020-03-12 - <em>Draft version</em></h3>
<p>Registration number: <strong>2020-60</strong></p>
<hr>
<p class="copyright-statement">
Copyright &copy; <a href="https://www.digg.se">The Swedish Agency for Digital Government (DIGG)</a>, 2015-2020. All Rights Reserved.
</p>

<h2 id="table-of-contents">Table of Contents</h2>
<ol class="list">
<li><p><a href="#introduction"><strong>Introduction</strong></a></p>
<p> 1.1. <a href="#requirements-notation">Requirements Notation</a></p>
<p> 1.2. <a href="#definitions">Definitions</a></p>
</li>
<li><p><a href="#signature-validation-token"><strong>Signature validation token</strong></a></p>
<p> 2.1. <a href="#function">Function</a></p>
<p> 2.2. <a href="#signature-validation-token-syntax">Signature Validation Token Syntax</a></p>
<p> 2.2.1. <a href="#data-types">Data Types</a></p>
<p> 2.2.2. <a href="#signature-validation-token-jwt-claims">Signature Validation Token JWT Claims</a></p>
<p> 2.2.3. <a href="#claim-object-classes">Claim Object Classes</a></p>
<p> 2.2.3.1. <a href="#the-sigvalidation-object">The SigValidation Object</a></p>
<p> 2.2.3.2. <a href="#the-signature-claims-object">The Signature Claims Object</a></p>
<p> 2.2.3.3. <a href="#the-sigreference-claims-object">The SigReference Claims Object</a></p>
<p> 2.2.3.4. <a href="#the-signeddata-claims-object">The SignedData Claims Object</a></p>
<p> 2.2.3.5. <a href="#the-policyvalidation-claims-object">The PolicyValidation Claims Object</a></p>
<p> 2.2.3.6. <a href="#the-timeverification-claims-object">The TimeVerification Claims Object</a></p>
<p> 2.2.3.7. <a href="#the-certreference-claims-object">The CertReference Claims Object</a></p>
<p> 2.2.4. <a href="#svt-jose-header">SVT JOSE Header</a></p>
</li>
<li><p><a href="#profiles"><strong>Profiles</strong></a></p>
</li>
<li><p><a href="#signature-validation-with-signature-validation-token"><strong>Signature Validation with Signature Validation Token</strong></a></p>
</li>
<li><p><a href="#examples"><strong>Examples</strong></a></p>
</li>
<li><p><a href="#normative-references"><strong>Normative References</strong></a></p>
</li>
</ol>
<hr>
<p><a name="introduction"></a></p>
<h2 id="1.-introduction">1. Introduction</h2>
<p>Electronic signatures have a limited lifespan regarding when they can be validated and determined to be authentic. Many factors make it more difficult to validate electronic signatures over time. For example:</p>
<ul class="list">
<li>Trusted information about the validity of the signing certificate is not available.</li>
<li>No proof of time when the signature was actually created is available.</li>
<li>Algorithms used to create the signature is no longer considered secure.</li>
<li>Services necessary to validate the signature are no longer available.</li>
<li>Inability to verify supporting evidence such as, CA certificates, OCSP responses, revocation lists or timestamps.</li>
</ul>
<p>The challenge to validate an electronic signature is increasing over time up until the point when it is simply impossible to verify the signature with a sufficient level of assurance.</p>
<p>Current existing standards such as the ETSI AdES profiles for CMS, XML and PDF signatures can be used to prolong the lifetime of a signature by storing data that supports validation of the signature beyond the lifetime of the signing certificate. The problem with this approach is that the amount of information that must be stored along with the signature is constantly growing over time. The increasing amount of information and signed objects that must be validated in order to verify the original signature is growing in complexity to the point where it may become infeasible to validate the original signature.</p>
<p>The Signature Validation Token (SVT) defined in this specification takes a fundamentally different approach to the problem by providing an evidence that asserts the validity of a signature. The SVT is issued by a trusted authority, and asserts that a particular signature was successfully validated according to defined procedures at a certain time. The basic idea and intent behind the SVT is that once the SVT is issued by a trusted authority, any future validation of that signature is satisfied by validating the SVT without any need to also validate the original signature.</p>
<p>This approach drastically reduces the complexity of signature validation of older signatures for the simple reason that validating the SVT just requires validation of the signature over the SVT. The SVT can be signed with keys and algorithms that makes it valid for a considerable time in the future and it can be re-issued with fresh keys and signatures to extend the lifetime of the original signature validity, if necessary.</p>
<p><a name="requirements-notation"></a></p>
<h3 id="1.1.-requirements-notation">1.1. Requirements Notation</h3>
<p>The key words <strong>MUST</strong>, <strong>MUST</strong> <strong>NOT</strong>, <strong>REQUIRED</strong>, <strong>SHALL</strong>, <strong>SHALL</strong> <strong>NOT</strong>, <strong>SHOULD</strong>, <strong>SHOULD</strong> <strong>NOT</strong>, <strong>RECOMMENDED</strong>, <strong>MAY</strong>, and <strong>OPTIONAL</strong> in this document are to be interpreted as described in BCP 14 [<a href="#rfc2119">RFC2119</a>] [<a href="#rfc8174">RFC8174</a>] when, and only when, they appear in all capitals, as shown here.</p>
<p>These keywords are capitalized when used to unambiguously specify requirements over protocol features and behavior that affect the interoperability and security of implementations. When these words are not capitalized, they are meant in their natural-language sense.</p>
<p><a name="definitions"></a></p>
<h3 id="1.2.-definitions">1.2. Definitions</h3>
<p>This document use the following defined terms:</p>
<table>
<thead>
<tr>
<th>Term</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>Signed Data</td>
<td>The data covered by a particular signature. This is typically equivalent to the signed document and represents the data that the signer intended to sign. In some cases, such as in some XML signatures, the signed data can be the collection of several data fragments each referenced by the signature. In the case of PDF, this is the data covered by the &quot;ByteRange&quot; parameter in the signature dictionary.</td>
</tr>
<tr>
<td>Signed Bytes</td>
<td>These are the actual bytes of data that was hashed and signed by the signature algorithm. In most cases this is not the actual Signed Data, but a collection of signature metadata that includes references (hash) of the Signed Data as well as information about algorithms and other data bound to a signature. In XML this is the canonicalized SignedInfo element and in CMS/PDF signatures this is the DER encoded SignedAttributes structure.</td>
</tr>
</tbody>
</table>
<p>When these terms are used in their defined meaning, they appear with a capitalized first letter as shown in the table.</p>
<p><a name="signature-validation-token"></a></p>
<h2 id="2.-signature-validation-token">2. Signature Validation Token</h2>
<p><a name="function"></a></p>
<h3 id="2.1.-function">2.1. Function</h3>
<p>The function of the Signature Validation Token (SVT) is to capture evidence of signature validity at one instance of secure signature validation process and to use that evidence to eliminate the need to perform any repeated cryptographic validation of the original signature value, as well as reliance on any hash values bound to that signature. The SVT achieves this by binding the following information to a specific electronic signature:</p>
<ul class="list">
<li>A unique identification of the signature.</li>
<li>The data and metadata signed by the signature.</li>
<li>The signer&#39;s certificate that was validated as part of signature validation.</li>
<li>The certificate chain that was used to validate the signer&#39;s certificate.</li>
<li>An assertion providing evidence of that the signature was validated, when in time the validation was performed, which procedures that was used to validate the signature, and the outcome of the validation.</li>
<li>An assertion providing evidence of the point in time at which the signature is known to have existed, which procedures that was used to validate the time of existence and the outcome of the validation.</li>
</ul>
<p>Using an SVT is equivalent to validating a signed document in a system once and then using that document multiple times without revalidating the signature for each usage. Such procedures are common in systems where the document is residing in a safe and trusted environment where it is protected against modification. The SVT allows the time and environment where the document can be stored and used to expand beyond a locally controlled environment and a short instance of time.</p>
<p>Using the SVT, the signed document can be validated once using a reliable trusted service and after that the SVT can be used to extend reliance of that secure validation process. The SVT is therefore not only a valuable tool to extend the lifetime of a signed document, but also useful since a single secure validation service can be deployed, instead of having to maintain close integrations between signature validations and document usage.</p>
<p><a name="signature-validation-token-syntax"></a></p>
<h3 id="2.2.-signature-validation-token-syntax">2.2. Signature Validation Token Syntax</h3>
<p>The SVT is carried in a JSON Web Token (JWT) in accordance with [<a href="#rfc7519">RFC7519</a>].</p>
<p><a name="data-types"></a></p>
<h3 id="2.2.1.-data-types">2.2.1. Data Types</h3>
<p>The contents of claims in an SVT are specified using the claims data types in the following table:</p>
<table>
<thead>
<tr>
<th>Claims Data Type</th>
<th>JSON Data Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>String</strong></td>
<td>string</td>
<td>An arbitrary case sensitive string value.</td>
</tr>
<tr>
<td><strong>Base64Binary</strong></td>
<td>string</td>
<td>String representation of Base64 encoded byte array of binary data.</td>
</tr>
<tr>
<td><strong>StringOrURI</strong></td>
<td>string</td>
<td>As defined in [<a href="#rfc7519">RFC7519</a>].<br/> A JSON string value, with the additional requirement that while arbitrary string values MAY be used, any value containing a &quot;:&quot; character MUST be a URI.</td>
</tr>
<tr>
<td><strong>URI</strong></td>
<td>string</td>
<td>A valid URI.</td>
</tr>
<tr>
<td><strong>Integer</strong></td>
<td>number</td>
<td>A 32-bit signed integer value (from -2<sup>31</sup> to 2<sup>31</sup> - 1).</td>
</tr>
<tr>
<td><strong>Long</strong></td>
<td>number</td>
<td>A 64-bit signed integer value (from -2<sup>63</sup> to 2<sup>63</sup> - 1).</td>
</tr>
<tr>
<td><strong>NumericDate</strong></td>
<td>number</td>
<td>As defined in [<a href="#rfc7519">RFC7519</a>].<br />A JSON numeric value representing the number of seconds from 1970-01-01T00:00:00Z UTC until the specified UTC date/time, ignoring leap seconds.</td>
</tr>
<tr>
<td><strong>Boolean</strong></td>
<td>boolean</td>
<td>The explicit value true or false.</td>
</tr>
<tr>
<td><strong>Object&lt;Class&gt;</strong></td>
<td>object</td>
<td>A JSON object holding a claims object of a class defined in this specification (see <a href="#signature-validation-token-jwt-claims">section 2.2.2</a>).</td>
</tr>
<tr>
<td><strong>Map&lt;Type&gt;</strong></td>
<td>object</td>
<td>A JSON object with name-value pairs where the value is an object of the specified Type in the notation.<br />Example: Map&lt;String&gt; according to this notation is a JSON object with name value pairs where all values are of type String.</td>
</tr>
<tr>
<td><strong>Array</strong></td>
<td>array</td>
<td>An array of values of a specific data type as defined in this table. An array is expressed in this specification by square brackets. For example: <strong>[String]</strong> indicates an array of String values and <strong>[Object&lt;DocHash&gt;]</strong> indicates an array of DocHash objects.</td>
</tr>
<tr>
<td><strong>Null</strong></td>
<td>null</td>
<td>Representing an absent value. A claim with a null value is equivalent with an absent claim in this specification.</td>
</tr>
</tbody>
</table>
<p><a name="signature-validation-token-jwt-claims"></a></p>
<h4 id="2.2.2.-signature-validation-token-jwt-claims">2.2.2. Signature Validation Token JWT Claims</h4>
<p>The signature validation token JWT SHALL contain claims according to the following table.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Data Type</th>
<th>Value</th>
<th>Presence</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>jti</code></td>
<td><strong>String</strong></td>
<td>A &quot;JWT ID&quot; registered claim according to [<a href="#rfc7519">RFC7519</a>]. It is RECOMMENDED that the identifier holds a hexadecimal string representation of a 128-bit unsigned integer.</td>
<td>MANDATORY</td>
</tr>
<tr>
<td><code>iss</code></td>
<td><strong>StringOrURI</strong></td>
<td>An &quot;Issuer&quot; registered claim according to [<a href="#rfc7519">RFC7519</a>]. An arbitrary unique identifier of the SVT issuer. This value SHOULD have the value of an URI identifier based on a domain owned by the issuer.</td>
<td>MANDATORY</td>
</tr>
<tr>
<td><code>iat</code></td>
<td><strong>NumericDate</strong></td>
<td>An &quot;Issued At&quot; registered claim according to [<a href="#rfc7519">RFC7519</a>] expressing the time when this SVT was issued.</td>
<td>MANDATORY</td>
</tr>
<tr>
<td><code>aud</code></td>
<td><strong>[StringOrURI]</strong> or <strong>StringOrURI</strong></td>
<td>An &quot;Audience&quot; registered claim according to [<a href="#rfc7519">RFC7519</a>]. The audience claim is an array of one or more identifiers, identifying intended recipients of the SVT. Each identifier MAY identify a single entity, a group of entities or a common policy adopted by a group of entities. If only one value is provided it MAY be provided as a single <strong>StringOrURI</strong> value instead of as an array of values.</td>
<td>OPTIONAL</td>
</tr>
<tr>
<td><code>exp</code></td>
<td><strong>NumericDate</strong></td>
<td>An &quot;Expiration Time&quot; registered claim according to [<a href="#rfc7519">RFC7519</a>] expressing the time when services and responsibilities related to this SVT is no longer provided by the SVT issuer. The precise meaning of the expiration time claim is defined by local policies. See implementation note below.</td>
<td>OPTIONAL</td>
</tr>
<tr>
<td><code>sig_val_claims</code></td>
<td><strong>Object&lt;SigValidation&gt;</strong></td>
<td>Signature validation claims for this SVT extending the standard registered JTW claims above.</td>
<td>MANDATORY</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Note</strong>: An SVT asserts that a certain validation process was undertaken at a certain instance of time. This fact never changes and never expires. However, some aspects of the SVT such as liability for false claims or service provision related to a specific SVT may expire after a certain period of time, such as a service where an old SVT can be upgraded to a new SVT signed with fresh keys and algorithms.</p>
</blockquote>
<p><a name="claim-object-classes"></a></p>
<h4 id="2.2.3.-claim-object-classes">2.2.3. Claim Object Classes</h4>
<p><a name="the-sigvalidation-object"></a></p>
<h5 id="2.2.3.1.-the-sigvalidation-object">2.2.3.1. The SigValidation Object</h5>
<p>The <strong>SigValidation</strong> claims object holds all custom claims of the SVT JWT and contains the following parameters:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Data Type</th>
<th>Value</th>
<th>Presence</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ver</code></td>
<td><strong>String</strong></td>
<td>Version. This version is indicated by the value &quot;1.0&quot;.</td>
<td>MANDATORY</td>
</tr>
<tr>
<td><code>profile</code></td>
<td><strong>StringOrURI</strong></td>
<td>Name of a profile applied to this specification that defines conventions of content of specific claims and extension points.</td>
<td>OPTIONAL</td>
</tr>
<tr>
<td><code>hash_algo</code></td>
<td><strong>URI</strong></td>
<td>The URI identifier of the hash algorithm used to provide hash values within the SVT. The URI identifier SHALL be one defined in [<a href="#rfc6931">RFC6931</a>] or in the IANA registry defined by this RFC.</td>
<td>MANDATORY</td>
</tr>
<tr>
<td><code>sig</code></td>
<td><strong>[Object&lt;Signature&gt;]</strong></td>
<td>Information about validated signatures as an array of <strong>Signature</strong> objects. If the SVT contains signature validation evidence for more than one signature, then each signature is represented by a separate <strong>Signature</strong> object. At least one <strong>Signature</strong> object MUST be present.</td>
<td>MANDATORY</td>
</tr>
<tr>
<td><code>ext</code></td>
<td><strong>Map&lt;String&gt;</strong></td>
<td>Extension point for additional claims related to the SVT. Extension claims are added at the discretion of the SVT issuer but MUST follow any conventions defined in a profile of this specification (see <a href="#profiles">section 3</a>).</td>
<td>OPTIONAL</td>
</tr>
</tbody>
</table>
<p><a name="the-signature-claims-object"></a></p>
<h5 id="2.2.3.2.-the-signature-claims-object">2.2.3.2. The Signature Claims Object</h5>
<p>The <strong>Signature</strong> object contains claims related to signature validation evidence for one signature and contains the following parameters:</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Data Type</th>
<th>Value</th>
<th>Presence</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sig_ref</code></td>
<td><strong>Object&lt;SigReference&gt;</strong></td>
<td>Reference information identifying the target signature.</td>
<td>MANDATORY</td>
</tr>
<tr>
<td><code>sig_data</code></td>
<td><strong>[Object&lt;SignedData&gt;]</strong></td>
<td>Array of references to Signed Data signed by the target signature.</td>
<td>MANDATORY</td>
</tr>
<tr>
<td><code>signer_cert_ref</code></td>
<td><strong>Object&lt;CertReference&gt;</strong></td>
<td>Reference to signer certificate and optionally reference to a supporting certificate chain that was used to validate the target signature.</td>
<td>MANDATORY</td>
</tr>
<tr>
<td><code>sig_val</code></td>
<td><strong>[Object&lt;PolicyValidation&gt;]</strong></td>
<td>Array of results of signature validation according to defined validation procedures.</td>
<td>MANDATORY</td>
</tr>
<tr>
<td><code>time_val</code></td>
<td><strong>[Object&lt;TimeValidation&gt;]</strong></td>
<td>Array of results of time verification validating proof that the target signature has existed at specific instances of time in the past.</td>
<td>OPTIONAL</td>
</tr>
<tr>
<td><code>ext</code></td>
<td><strong>MAP&lt;String&gt;</strong></td>
<td>Extension point for additional claims related to the target signature. Extension claims are added at the discretion of the SVT Issuer but MUST follow any conventions defined in a profile of this specification (see <a href="#profiles">section 3</a>).</td>
<td>OPTIONAL</td>
</tr>
</tbody>
</table>
<p><a name="the-sigreference-claims-object"></a></p>
<h5 id="2.2.3.3.-the-sigreference-claims-object">2.2.3.3. The SigReference Claims Object</h5>
<p>The <strong>SigReference</strong> claims object provides information used to match the <strong>Signature</strong> claims object to a specific target signature and to verify the integrity of the target signature value and Signed Bytes.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Data Type</th>
<th>Value</th>
<th>Presence</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>id</code></td>
<td><strong>String</strong></td>
<td>Optional identifier assigned to the target signature.</td>
<td>OPTIONAL</td>
</tr>
<tr>
<td><code>sig_hash</code></td>
<td><strong>Base64Binary</strong></td>
<td>Hash value of the target signature value.</td>
<td>MANDATORY</td>
</tr>
<tr>
<td><code>sb_hash</code></td>
<td><strong>Base64Binary</strong></td>
<td>Hash value of the Signed Bytes of the target signature.</td>
<td>MANDATORY</td>
</tr>
</tbody>
</table>
<p><a name="the-signeddata-claims-object"></a></p>
<h5 id="2.2.3.4.-the-signeddata-claims-object">2.2.3.4. The SignedData Claims Object</h5>
<p>The <strong>SignedData</strong> claims object provides information used to verify the target signature references to Signed Data as well as to verify the integrity of all data signed by the target signature.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Data Type</th>
<th>Value</th>
<th>Presence</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ref</code></td>
<td><strong>String</strong></td>
<td>Reference identifier identifying the data or data fragment covered by the target signature.</td>
<td>MANDATORY</td>
</tr>
<tr>
<td><code>hash</code></td>
<td><strong>Base64Binary</strong></td>
<td>Hash of the data covered by the target signature.</td>
<td>MANDATORY</td>
</tr>
</tbody>
</table>
<p><a name="the-policyvalidation-claims-object"></a></p>
<h5 id="2.2.3.5.-the-policyvalidation-claims-object">2.2.3.5. The PolicyValidation Claims Object</h5>
<p>The <strong>PolicyValidation</strong> claims object provide information about the result of a validation process according to a spefific policy.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Data Type</th>
<th>Value</th>
<th>Presence</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>pol</code></td>
<td><strong>StringOrURI</strong></td>
<td>Identifier of the policy governing the validation process.</td>
<td>MANDATORY</td>
</tr>
<tr>
<td><code>res</code></td>
<td><strong>String</strong></td>
<td>Result of the validation process. The value MUST be one of &quot;PASSED&quot;, &quot;FAILED&quot; or &quot;INDETERMINATE&quot; as defined by [<a href="#etsi319102-1">ETSI EN 319 102-1</a>].</td>
<td>MANDATORY</td>
</tr>
<tr>
<td><code>msg</code></td>
<td><strong>String</strong></td>
<td>An optional message describing the result.</td>
<td>OPTIONAL</td>
</tr>
<tr>
<td><code>ext</code></td>
<td><strong>Map&lt;String&gt;</strong></td>
<td>Extension for additional information about the validation result.</td>
<td>OPTIONAL</td>
</tr>
</tbody>
</table>
<p><a name="the-timeverification-claims-object"></a></p>
<h5 id="2.2.3.6.-the-timeverification-claims-object">2.2.3.6. The TimeVerification Claims Object</h5>
<p>The <strong>TimeVerification</strong> claims object provide information about the result of validating time evidence asserting that the target signature existed at a particular time in the past.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Data Type</th>
<th>Value</th>
<th>Presence</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>time</code></td>
<td><strong>NumericDate</strong></td>
<td>The verified time.</td>
<td>MANDATORY</td>
</tr>
<tr>
<td><code>type</code></td>
<td><strong>StringOrURI</strong></td>
<td>Identifier of the type of evidence of time.</td>
<td>MANDATORY</td>
</tr>
<tr>
<td><code>iss</code></td>
<td><strong>StringOrURI</strong></td>
<td>Identifier of the entity that issued the evidence of time.</td>
<td>MANDATORY</td>
</tr>
<tr>
<td><code>id</code></td>
<td><strong>String</strong></td>
<td>Unique identifier assigned to the evidence of time.</td>
<td>OPTIONAL</td>
</tr>
<tr>
<td><code>val</code></td>
<td><strong>[Object&lt;PolicyValidation&gt;]</strong></td>
<td>Array of results of validation of the time evidence according to defined validation procedures.</td>
<td>OPTIONAL</td>
</tr>
<tr>
<td><code>ext</code></td>
<td><strong>Map&lt;String&gt;</strong></td>
<td>Extension for additional information about the signature validation result.</td>
<td>OPTIONAL</td>
</tr>
</tbody>
</table>
<p><a name="the-certreference-claims-object"></a></p>
<h5 id="2.2.3.7.-the-certreference-claims-object">2.2.3.7. The CertReference Claims Object</h5>
<p>The <strong>CertReference</strong> claims object allows reference to a single X.509 certificate or a chain of X.509 certificates, either by providing the actual certificate data or by providing a hash reference for certificates that can be located in the target signature.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Data Type</th>
<th>Value</th>
<th>Presence</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><strong>StringOrURI</strong></td>
<td>An identifier of the type of reference provided in the <code>ref</code> claim. The type identifier MUST be either one of the identifiers defined below, an identifier specified by the selected profile, or a URI identifier.</td>
<td>MANDATORY</td>
</tr>
<tr>
<td><code>ref</code></td>
<td><strong>[String]</strong></td>
<td>An array of string parameters according to conventions defined by the type identifier.</td>
<td>MANDATORY</td>
</tr>
</tbody>
</table>
<p>The following type identifiers are defined:</p>
<table>
<thead>
<tr>
<th>Identifer</th>
<th>Ref Data Content</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>chain</code></td>
<td>Array of Base64 encoded X.509 certificates [<a href="#rfc5280">RFC5280</a>]. The certificates MUST be stored in the order starting with the end entity certificate. Any following certificate must be able to validate the signature on the previous certificate in the array.</td>
</tr>
<tr>
<td><code>chain_hash</code></td>
<td>An array of one or two Base64 encoded hash values. The first hash value MUST be present and holds the hash over the signer&#39;s end entity X.509 certificate [<a href="#rfc5280">RFC5280</a>]. The second hash is the Base64 encoded hash over the complete certificate chain included in the target signature (including the signer&#39;s certificate). The chain hash is calculated over the concatenated bytes of the chain certificates exactly in the order they appear in the target signature. If the second hash value MAY be absent if the chain only contains the signer&#39;s certificate. The secound hash value MUST be present if the chain contains any certificates other than the signer&#39;s certificate.</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Note</strong>: All certificates referenced using the identifiers above are X.509 certificates. Profiles of this specification MAY define alternative types of public key containers. It should be noted however that a major function of these referenced certificates is not just to reference the public key, but also to provide the identity of the signer. It is therefore important for the full function of an SVT that the referenced public key container also provides the means to identify of the signer.</p>
</blockquote>
<p><a name="svt-jose-header"></a></p>
<h4 id="2.2.4.-svt-jose-header">2.2.4. SVT JOSE Header</h4>
<p>The SVT JWT MUST contain the following JOSE header parameters in accordance with section 5 of [<a href="#rfc7519">RFC7519</a>].</p>
<table>
<thead>
<tr>
<th>JOSE Header</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>typ</code></td>
<td>This parameter MUST have the string value &quot;JWT&quot; (upper case).</td>
</tr>
<tr>
<td><code>alg</code></td>
<td>Specifying the algorithm used to sign the SVT JWT using a value specified in [<a href="#rfc7518">RFC7518</a>]. The specified signature hash algorithm MUST be identical to the hash algorithm specified in the <strong>SigValAssertion</strong> claims object <code>hash_algo</code> claim.</td>
</tr>
</tbody>
</table>
<p>The SVT header MUST contain a public key or a reference to a public key used to verify the signature on the SVT in accordance with [<a href="#rfc7515">RFC7515</a>]. Each profile (See section 3.) MUST define the requirements for how the key or key reference is included in the header.</p>
<p><a name="profiles"></a></p>
<h2 id="3.-profiles">3. Profiles</h2>
<p>Each signed document and signature type will have to define the precise content and use of several claims in the SVT.</p>
<p>Each profile MUST as a minimum define:</p>
<ul class="list">
<li>How to specify reference to Signed Data content of the signed document.</li>
<li>How to make reference to the target signature and the Signed Bytes of the signature.</li>
<li>How references should be made to certificates supporting each siganture.</li>
<li>How public keys or reference to public keys supporting validation of the signed SVT is included in the SVT.</li>
<li>Whether each signature is supported by it&#39;s own SVT, or whether one SVT may support multiple signatures of the same document.</li>
<li>Explicit information on how to perform signature validation based on an SVT, if applicable.</li>
<li>How to attach an SVT to a document signature or signed document, if applicable.</li>
</ul>
<p><a name="signature-validation-with-signature-validation-token"></a></p>
<h2 id="4.-signature-validation-with-signature-validation-token">4. Signature Validation with Signature Validation Token</h2>
<p>Signature validation based on an SVT SHALL follow the following basic steps:</p>
<ol class="list">
<li><p>Locate all available tokens available for the signed document that is relevant for the target signature.</p>
</li>
<li><p>Select the most recent SVT that can be successfully validated and meets the requirement of the relying party.</p>
</li>
<li><p>Verify the integrity of the signature and the Signed Bytes of the target signature using the <code>sig_ref</code> claim.</p>
</li>
<li><p>Verify that the Signed Data reference in the original signature matches the reference values in the <code>sig_data_ref</code> claim.</p>
</li>
<li><p>Verify the integrity of referenced Signed Data using provided hash values in the <code>sig_data_ref</code> claim.</p>
</li>
<li><p>Obtain the verified certificates supporting the asserted signature validation through the <code>signer_cert_ref</code> claim.</p>
</li>
<li><p>Verify that signature validation policy results satisfy the requirements of the relying party.</p>
</li>
<li><p>Verify that verified time results satisfy the context within which the signed document is used.</p>
</li>
</ol>
<p>After validating these steps, signature validity is established as well as the trusted signer certificate binding the identity of the signer to the signature.</p>
<p><a name="examples"></a></p>
<h2 id="5.-examples">5. Examples</h2>
<p>The following example illustrates a basic SVT according to this specification issued for a signed PDF document.</p>
<p>Signature validation token JWT:</p>
<pre class="hljs"><code>eyJraWQiOiJPZW<span class="hljs-number">5</span>JKzQzNEpoYnZmRG<span class="hljs-number">50</span>ZlZcLzhyT<span class="hljs-number">3</span>hHN<span class="hljs-number">0</span>ZrdnlqYUtWSmFWcUlGQlhvaFZoQWU<span class="hljs-number">1</span>Zks<span class="hljs-number">4</span>YW<span class="hljs-number">5</span>vdjFTNjg<span class="hljs-number">4</span>
cjdLYmFsK<span class="hljs-number">2</span>Z<span class="hljs-number">2</span>cGFIMWo<span class="hljs-number">4</span>aWJnNTJRQnkxUFE<span class="hljs-number">9</span>PSIsInR<span class="hljs-number">5</span>cCI<span class="hljs-number">6</span>IkpXVCIsImFsZyI<span class="hljs-number">6</span>IlJTNTEyIn<span class="hljs-number">0</span>.eyJhdWQiOiJodHRw
OlwvXC<span class="hljs-number">9</span>leGFtcGxlLmNvbVwvYXVkaWVuY<span class="hljs-number">2</span>UxIiwiaXNzIjoiaHR<span class="hljs-number">0</span>cHM<span class="hljs-number">6</span>XC<span class="hljs-number">9</span>cL<span class="hljs-number">3</span>N<span class="hljs-number">3</span>ZWRlbmNvbm<span class="hljs-number">5</span>lY<span class="hljs-number">3</span>Quc<span class="hljs-number">2</span>VcL<span class="hljs-number">3</span>ZhbGlk
YXRvciIsImlhdCI<span class="hljs-number">6</span>MTU<span class="hljs-number">4</span>MjczMDY<span class="hljs-number">0</span>NSwianRpIjoiZTIyYzViZTZkZDZjYzZkYjgzNGJjY<span class="hljs-number">2</span>QwNjZmNWUyZTMiLCJzaWdf
dmFsX<span class="hljs-number">2</span>NsYWltcyI<span class="hljs-number">6</span>eyJzaWciOlt<span class="hljs-number">7</span>ImV<span class="hljs-number">4</span>dCI<span class="hljs-number">6</span>bnVsbCwic<span class="hljs-number">2</span>lnX<span class="hljs-number">3</span>ZhbCI<span class="hljs-number">6</span>W<span class="hljs-number">3</span>sibXNnIjoiSW<span class="hljs-number">52</span>YWxpZCBzaWduYXR<span class="hljs-number">1</span>cmUi
LCJleHQiOm<span class="hljs-number">51</span>bGwsInJlcyI<span class="hljs-number">6</span>IkZBSUxFRCIsInBvbCI<span class="hljs-number">6</span>Imh<span class="hljs-number">0</span>dHA<span class="hljs-number">6</span>XC<span class="hljs-number">9</span>cL<span class="hljs-number">2</span>lkLnN<span class="hljs-number">3</span>ZWRlbmNvbm<span class="hljs-number">5</span>lY<span class="hljs-number">3</span>Quc<span class="hljs-number">2</span>VcL<span class="hljs-number">3</span>N<span class="hljs-number">2</span>dFwv
<span class="hljs-keyword">c</span><span class="hljs-number">2</span>lndmFsLXBvbGljeVwvY<span class="hljs-number">2</span>hhaW<span class="hljs-number">5</span>cLzAxIn<span class="hljs-number">1</span>dLCJzaWdfcmVmIjp<span class="hljs-number">7</span>InNpZ<span class="hljs-number">19</span>oYXNoIjoiQmh<span class="hljs-number">1</span>RTlCQ<span class="hljs-number">1</span>lkcUxneW<span class="hljs-number">93</span>bDJQ
Ym<span class="hljs-number">1</span>uSzlkSkFtaVZ<span class="hljs-number">0</span>VDF<span class="hljs-number">1</span>OVZnaUY<span class="hljs-number">5</span>OWgyaFZQekU<span class="hljs-number">0</span>WExXdmJDUGU<span class="hljs-number">0</span>YUNKM<span class="hljs-number">0</span>l<span class="hljs-number">6</span>RmZvTDlrM<span class="hljs-number">3</span>RXcjBXK<span class="hljs-number">3</span>d<span class="hljs-number">5</span>OUJlcWlyY<span class="hljs-number">1E9</span>
PSIsImlkIjpudWxsLCJzYl<span class="hljs-number">9</span>oYXNoIjoiYnVlcTVIVE<span class="hljs-number">8</span>xYnRwQ<span class="hljs-number">3</span>JYUlg<span class="hljs-number">3</span>VHpFS<span class="hljs-number">1</span>VyTkpRaEdHOHFCaDR<span class="hljs-number">3</span>eEVTcVJMM<span class="hljs-number">0</span>J<span class="hljs-number">6</span>
bjRjbHZLMzdqWXUwS<span class="hljs-number">2</span>pNTWtnSlFFTWZBMWIzaW<span class="hljs-number">1</span>peTc<span class="hljs-number">5</span>dDdoK<span class="hljs-number">1</span>loOHc<span class="hljs-number">9</span>PSJ<span class="hljs-number">9</span>LCJzaWduZXJfY<span class="hljs-number">2</span>VydF<span class="hljs-number">9</span>yZWYiOnsicmVm
IjpbIk<span class="hljs-number">5</span>TdUZNXC<span class="hljs-number">92</span>SitiZUJsUXRRVHptY<span class="hljs-number">1</span>loNXg<span class="hljs-number">3</span>TDhXQzlFMUtQSFJBMWlvTk<span class="hljs-number">9</span>sS<span class="hljs-number">1</span>ZHYmxhOVVSelljc<span class="hljs-number">2</span>lzQXgyYmNz
cU<span class="hljs-number">9</span>oa<span class="hljs-number">3</span>ZWVGMzbUs<span class="hljs-number">5</span>RTZhZzA<span class="hljs-number">3</span>aGZhdz<span class="hljs-number">09</span>Il<span class="hljs-number">0</span>sInR<span class="hljs-number">5</span>cGUiOiJjaGFpbl<span class="hljs-number">9</span>oYXNoIn<span class="hljs-number">0</span>sInNpZ<span class="hljs-number">19</span>kYXRhX<span class="hljs-number">3</span>JlZiI<span class="hljs-number">6</span>W<span class="hljs-number">3</span>sicmVm
IjoiMCAxMjI<span class="hljs-number">5</span>MzUgMTI<span class="hljs-number">3</span>OTM<span class="hljs-number">3</span>IDI<span class="hljs-number">3</span>NDMwIiwiaGFzaCI<span class="hljs-number">6</span>Imt<span class="hljs-number">1</span>VWI<span class="hljs-number">4</span>NkZzTU<span class="hljs-number">5</span>tSmwzdjRiUUswOUZrUWd<span class="hljs-number">2</span>bzlReDAxbk<span class="hljs-number">5</span>S
eVFLVVppaEdFdW<span class="hljs-number">1</span>kVnF<span class="hljs-number">0</span>dUJLTlBxWkkxVHpDUWV<span class="hljs-number">3</span>Nm<span class="hljs-number">44</span>b<span class="hljs-number">0</span>ZNak<span class="hljs-number">5</span>oQjhDMFhNSmxrRE<span class="hljs-number">9</span>RPT<span class="hljs-number">0</span>ifV<span class="hljs-number">0</span>sInRpbWVfdmFsIjpb
XX<span class="hljs-number">1</span>dLCJleHQiOnsibmFtZTIiOiJ<span class="hljs-number">2</span>YWwyIiwibmFtZTEiOiJ<span class="hljs-number">2</span>YWwxIn<span class="hljs-number">0</span>sInZlciI<span class="hljs-number">6</span>IjEuMCIsInByb<span class="hljs-number">2</span>ZpbGUiOiJQREYi
LCJoYXNoX<span class="hljs-number">2</span>FsZ<span class="hljs-number">28</span>iOiJodHRwOlwvXC<span class="hljs-number">93</span>d<span class="hljs-number">3</span>cudzMub<span class="hljs-number">3</span>JnXC<span class="hljs-number">8</span>yMDAxXC<span class="hljs-number">8</span>wNFwveG<span class="hljs-number">1</span>sZW<span class="hljs-number">5</span>jI<span class="hljs-number">3</span>NoYTUxMiJ<span class="hljs-number">9</span>fQ.DhrCRxT_U
<span class="hljs-number">8</span>LeqK<span class="hljs-number">1</span>BU<span class="hljs-number">9</span><span class="hljs-number">-5</span>Bqu<span class="hljs-keyword">i2</span>cs<span class="hljs-number">5</span>n<span class="hljs-number">21</span>PrSqPnDtVa<span class="hljs-number">7</span>mxUtqTnouOXjVfuWR<span class="hljs-number">0</span>lfNAjEkc<span class="hljs-number">1</span>y<span class="hljs-number">2</span>QSX<span class="hljs-number">5</span><span class="hljs-keyword">x</span><span class="hljs-number">2</span>dmMdCpNLWX<span class="hljs-number">127</span>UHYiAm<span class="hljs-number">8</span>NzeY
uoWqdnxKiy<span class="hljs-number">61</span>hZ<span class="hljs-number">1</span>l<span class="hljs-number">0</span>Jldnk<span class="hljs-number">52</span>ngG_<span class="hljs-number">2</span>UNDnrCGBo<span class="hljs-number">9</span>OgC<span class="hljs-number">90</span>kG<span class="hljs-number">2</span>bFQimZB<span class="hljs-number">3</span>WgVtE<span class="hljs-number">7</span>ad_HAwIXwd-vEHt<span class="hljs-number">6</span>Sf<span class="hljs-number">2</span>yWXlUTYqQ<span class="hljs-number">1</span>Dx
gq<span class="hljs-number">6</span>pTKQnuf<span class="hljs-number">5</span>ahsHVyeDihgNeix<span class="hljs-number">8</span>-cGx<span class="hljs-number">1</span>MEvvHNUpCcIXBx<span class="hljs-number">67</span>BEcZ-SrqRoIZkVqEcW<span class="hljs-number">83</span>KFMgqKWmWDgp<span class="hljs-number">4</span>z_CKM<span class="hljs-number">5</span>ix<span class="hljs-number">2</span>dV
zwp<span class="hljs-number">1</span>GvYOM<span class="hljs-number">6</span>M<span class="hljs-number">3</span>QUKYgmiNA<span class="hljs-number">6</span>dMWJvXeJZ-KK<span class="hljs-keyword">i5</span>A<span class="hljs-number">-6</span>gEqfgOsixuZechcDon_<span class="hljs-number">3</span>nMzEeNBSJFXU<span class="hljs-number">7</span>ohkvxIJN<span class="hljs-number">9</span>LXNFAxzAT<span class="hljs-number">2</span>U
mASxrL<span class="hljs-number">9</span>wvaQMmJHYMeet-vUsOPWcsq<span class="hljs-number">07</span>eKO<span class="hljs-number">5</span>bnsYwrs<span class="hljs-number">9</span>igYeotgcT_Nl<span class="hljs-number">74</span>Rmf<span class="hljs-number">9</span>uMye_IgyzlS_NLL<span class="hljs-number">4</span>xq<span class="hljs-number">9</span>Aaf<span class="hljs-number">6</span>LPXWZ<span class="hljs-number">0</span>S
_plugvfzv<span class="hljs-number">7</span>HuzXNOY<span class="hljs-number">994</span>voq<span class="hljs-number">8</span>sOpO<span class="hljs-number">9</span>xKYhqYnzbdDFKU</code></pre><p>Decoded JWT Header:</p>
<pre class="hljs"><code>{
  <span class="hljs-string">"kid"</span>:<span class="hljs-string">"OenI+434JhbvfDntfV\/8rOxG7FkvyjaKVJaVqIFBXohVhAe5fK8anov1S688r7Kbal+fvpaH1j8ibg52QB</span>
         y1PQ==<span class="hljs-string">",</span>
  <span class="hljs-string">"typ"</span> : <span class="hljs-string">"JWT"</span>,
  <span class="hljs-string">"alg"</span> : <span class="hljs-string">"RS512"</span>
}</code></pre><p>Decoded JWT Claims:</p>
<pre class="hljs"><code>{
  <span class="hljs-string">"aud"</span> : <span class="hljs-string">"http://example.com/audience1"</span>,
  <span class="hljs-string">"iss"</span> : <span class="hljs-string">"https://swedenconnect.se/validator"</span>,
  <span class="hljs-string">"iat"</span> : <span class="hljs-number">1582730645</span>,
  <span class="hljs-string">"jti"</span> : <span class="hljs-string">"e22c5be6dd6cc6db834bccd066f5e2e3"</span>,
  <span class="hljs-string">"sig_val_claims"</span> : {
    <span class="hljs-string">"sig"</span> : [ {
      <span class="hljs-string">"ext"</span> : null,
      <span class="hljs-string">"sig_val"</span> : [ {
        <span class="hljs-string">"msg"</span> : <span class="hljs-string">"Invalid signature"</span>,
        <span class="hljs-string">"ext"</span> : null,
        <span class="hljs-string">"res"</span> : <span class="hljs-string">"FAILED"</span>,
        <span class="hljs-string">"pol"</span> : <span class="hljs-string">"http://id.swedenconnect.se/svt/sigval-policy/chain/01"</span>
      } ],
      <span class="hljs-string">"sig_ref"</span> : {
        <span class="hljs-string">"sig_hash"</span> : <span class="hljs-string">"BhuE9BCYdqLgyowl2PbmnK9dJAmiVtT1u9VgiF99h2hVPzE4XLWvbCPe4aCJ3IzFfoL9k3
                      tWr0W+wy9BeqircQ=="</span>,
        <span class="hljs-string">"id"</span> : null,
        <span class="hljs-string">"sb_hash"</span> : <span class="hljs-string">"bueq5HTO1btpCrXRX7TzEKUrNJQhGG8qBh4wxESqRL3Bzn4clvK37jYu0KjMMkgJQEMfA1b
                     3imiy79t7h+Yh8w=="</span>
      },
      <span class="hljs-string">"signer_cert_ref"</span> : {
        <span class="hljs-string">"ref"</span> : [ <span class="hljs-string">"NSuFM/vJ+beBlQtQTzmcYh5x7L8WC9E1KPHRA1ioNOlKVGbla9URzYcsisAx2bcsqOhkvVTc3
                   mK9E6ag07hfaw=="</span> ],
        <span class="hljs-string">"type"</span> : <span class="hljs-string">"chain_hash"</span>
      },
      <span class="hljs-string">"sig_data_ref"</span> : [ {
        <span class="hljs-string">"ref"</span> : <span class="hljs-string">"0 122935 127937 27430"</span>,
        <span class="hljs-string">"hash"</span> : <span class="hljs-string">"kuUb86FsMNmJl3v4bQK09FkQgvo9Qx01nNRyQKUZihGEumdVqtuBKNPqZI1TzCQew6n8oFMjNh
                  B8C0XMJlkDOQ=="</span>
      } ],
      <span class="hljs-string">"time_val"</span> : [ ]
    } ],
    <span class="hljs-string">"ext"</span> : {
      <span class="hljs-string">"name2"</span> : <span class="hljs-string">"val2"</span>,
      <span class="hljs-string">"name1"</span> : <span class="hljs-string">"val1"</span>
    },
    <span class="hljs-string">"ver"</span> : <span class="hljs-string">"1.0"</span>,
    <span class="hljs-string">"profile"</span> : <span class="hljs-string">"PDF"</span>,
    <span class="hljs-string">"hash_algo"</span> : <span class="hljs-string">"http://www.w3.org/2001/04/xmlenc#sha512"</span>
  }
}</code></pre><blockquote>
<p>Note: Line breaks in the decoded example are inserted for readablilty. These are not allowed in valid JSON data.</p>
</blockquote>
<p><a name="normative-references"></a></p>
<h2 id="6.-normative-references">6. Normative References</h2>
<p><a name="rfc2119"></a>
<strong>[RFC2119]</strong></p>
<blockquote>
<p><a href="https://www.ietf.org/rfc/rfc2119.txt">Bradner, S., Key words for use in RFCs to Indicate Requirement
Levels, March 1997</a>.</p>
</blockquote>
<p><a name="rfc5280"></a>
<strong>[RFC5280]</strong></p>
<blockquote>
<p><a href="https://www.ietf.org/rfc/rfc5280.txt">D. Cooper, S. Santesson, S. Farrell, S. Boeyen, R. Housley, W. Polk, Internet
X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL)
Profile, May 2008</a>.</p>
</blockquote>
<p><a name="rfc6931"></a>
<strong>[RFC6931]</strong></p>
<blockquote>
<p><a href="https://www.ietf.org/rfc/rfc6931.txt">Eastlake 3rd, D., Additional XML Security Uniform Resource Identifiers
(URIs), April 2013</a>.</p>
</blockquote>
<p><a name="rfc7515"></a>
<strong>[RFC7515]</strong></p>
<blockquote>
<p><a href="https://www.ietf.org/rfc/rfc7515.txt">Jones, M., Bradley, J., Sakimura, N., JSON Web Signature (JWS), May 2015</a>.</p>
</blockquote>
<p><a name="rfc7518"></a>
<strong>[RFC7518]</strong></p>
<blockquote>
<p><a href="https://www.ietf.org/rfc/rfc7518.txt">Jones, M., JSON Web Algorithms (JWA), May 2015</a>.</p>
</blockquote>
<p><a name="rfc7519"></a>
<strong>[RFC7519]</strong></p>
<blockquote>
<p><a href="https://www.ietf.org/rfc/rfc7518.txt">Jones, M., Bradley, J., Sakimura, N., JSON Web Token (JWT), May 2015</a>.</p>
</blockquote>
<p><a name="rfc8174"></a>
<strong>[RFC8174]</strong></p>
<blockquote>
<p><a href="https://www.ietf.org/rfc/rfc8174.txt">Leiba, B., Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words, May 2017</a>.</p>
</blockquote>
<p><a name="etsi319102-1"></a>
<strong>[ETSI EN 319 102-1]</strong></p>
<blockquote>
<p><a href="https://www.etsi.org/deliver/etsi_en/319100_319199/31910201/01.01.01_60/en_31910201v010101p.pdf">ETSI - Electronic Signatures and Infrastructures (ESI); Procedures for
Creation and Validation of AdES Digital Signatures; Part 1: Creation and
Validation</a>.</p>
</blockquote>
    </article>
  </body>
</html>
